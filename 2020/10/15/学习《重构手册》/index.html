<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 8.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/favicon.ico" color="#222">
  <meta name="baidu-site-verification" content="K0iqERgnmF">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.ponder.work","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta property="og:type" content="article">
<meta property="og:title" content="学习《重构手册》">
<meta property="og:url" content="https://blog.ponder.work/2020/10/15/%E5%AD%A6%E4%B9%A0%E3%80%8A%E9%87%8D%E6%9E%84%E6%89%8B%E5%86%8C%E3%80%8B/index.html">
<meta property="og:site_name" content="逸思杂陈">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-%E9%87%8D%E6%9E%84%E6%89%8B%E5%86%8C-%E5%BC%82%E5%91%B3.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-move-method-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-move-method-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-move-field-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-move-field-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-extract-class-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-extract-class-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-inline-class-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-inline-class-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-hide-delegate-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-hide-delegate-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-remove-middle-man-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-remove-middle-man-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-introduce-local-extension-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-introduce-local-extension-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-change-value-to-reference-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-change-value-to-reference-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-change-reference-to-value-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-change-reference-to-value-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-duplicate-observed-data-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-duplicate-observed-data-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-data-value-with-object-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-data-value-with-object-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-change-unidirectional-association-to-bidirectional-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-change-unidirectional-association-to-bidirectional-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-change-bidirectional-association-to-unidirectional-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-change-bidirectional-association-to-unidirectional-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-encapsulate-collection-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-encapsulate-collection-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-type-code-with-class-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-type-code-with-class-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-type-code-with-subclasses-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-type-code-with-subclasses-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-type-code-with-state-strategy-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-type-code-with-state-strategy-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-subclass-with-fields-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-subclass-with-fields-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-add-parameter-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-add-parameter-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-remove-parameter-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-remove-parameter-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-rename-method-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-rename-method-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-separate-query-from-modifier-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-separate-query-from-modifier-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-parameterize-method-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-parameterize-method-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-introduce-parameter-object-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-introduce-parameter-object-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-remove-setting-method-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-remove-setting-method-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-hide-method-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-hide-method-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-pull-up-field-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-pull-up-field-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-pull-up-method-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-pull-up-method-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-push-down-field-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-push-down-field-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-push-down-method-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-push-down-method-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-extract-subclass-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-extract-subclass-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-extract-superclass-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-extract-superclass-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-extract-interface-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-extract-interface-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-collapse-hierarchy-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-collapse-hierarchy-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-form-template-method-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-form-template-method-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-inheritance-with-delegation-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-inheritance-with-delegation-after.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-delegation-with-inheritance-before.png">
<meta property="og:image" content="https://image.ponder.work/mweb/2020-10-18-replace-delegation-with-inheritance-after.png">
<meta property="article:published_time" content="2020-10-15T13:48:00.000Z">
<meta property="article:modified_time" content="2024-07-09T14:02:56.000Z">
<meta property="article:author" content="Jay.Run">
<meta property="article:tag" content="读书笔记">
<meta property="article:tag" content="重构">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://image.ponder.work/mweb/2020-10-18-%E9%87%8D%E6%9E%84%E6%89%8B%E5%86%8C-%E5%BC%82%E5%91%B3.png">


<link rel="canonical" href="https://blog.ponder.work/2020/10/15/%E5%AD%A6%E4%B9%A0%E3%80%8A%E9%87%8D%E6%9E%84%E6%89%8B%E5%86%8C%E3%80%8B/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://blog.ponder.work/2020/10/15/%E5%AD%A6%E4%B9%A0%E3%80%8A%E9%87%8D%E6%9E%84%E6%89%8B%E5%86%8C%E3%80%8B/","path":"2020/10/15/学习《重构手册》/","title":"学习《重构手册》"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>学习《重构手册》 | 逸思杂陈</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134911454-2"></script>
  <script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-134911454-2","only_pageview":false,"measure_protocol_api_secret":null}</script>
  <script src="/js/third-party/analytics/google-analytics.js" defer></script>

  <script src="/js/third-party/analytics/baidu-analytics.js" defer></script>
  <script async src="https://hm.baidu.com/hm.js?11c4bbd295ba9de285292ef966eb17b7"></script>







  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/pjax.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.10.1/mermaid.min.js","integrity":"sha256-BmQmdWDS8X2OTbrwELWK366LV6escyWhHHe0XCTU/Hk="}}</script>
  <script src="/js/third-party/tags/mermaid.js" defer></script>


  <script src="/js/third-party/fancybox.js" defer></script>



  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js" defer></script>




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="逸思杂陈" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">逸思杂陈</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">人类一思考，上帝就发笑。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-编程"><a href="/categories/programming/" rel="section"><i class="fa fa-code fa-fw"></i>编程</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B1%BB%E4%B8%AD%E7%9A%84%E5%BC%82%E5%91%B3"><span class="nav-number">1.</span> <span class="nav-text">类中的异味</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E5%BA%A6%E9%87%8F%E7%9A%84%E5%BC%82%E5%91%B3"><span class="nav-number">1.1.</span> <span class="nav-text">可度量的异味</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E9%87%8A"><span class="nav-number">1.1.1.</span> <span class="nav-text">注释</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%87%E9%95%BF%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">1.1.2.</span> <span class="nav-text">过长的方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%87%E5%A4%A7%E7%9A%84%E7%B1%BB"><span class="nav-number">1.1.3.</span> <span class="nav-text">过大的类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%87%E9%95%BF%E7%9A%84%E5%8F%82%E6%95%B0%E8%A1%A8"><span class="nav-number">1.1.4.</span> <span class="nav-text">过长的参数表</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%BD%E5%90%8D"><span class="nav-number">1.2.</span> <span class="nav-text">命名</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8D%E5%AD%97%E4%B8%AD%E5%8C%85%E5%90%AB%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.2.1.</span> <span class="nav-text">名字中包含类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E8%BE%BE%E5%8A%9B%E5%B7%AE%E7%9A%84%E5%90%8D%E5%AD%97"><span class="nav-number">1.2.2.</span> <span class="nav-text">表达力差的名字</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E4%B8%80%E8%87%B4%E7%9A%84%E5%90%8D%E5%AD%97"><span class="nav-number">1.2.3.</span> <span class="nav-text">不一致的名字</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E5%BF%85%E8%A6%81%E7%9A%84%E5%A4%8D%E6%9D%82%E6%80%A7"><span class="nav-number">1.3.</span> <span class="nav-text">不必要的复杂性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%BB%E4%BB%A3%E7%A0%81"><span class="nav-number">1.3.1.</span> <span class="nav-text">死代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%87%E5%88%86%E4%B8%80%E8%88%AC%E6%80%A7"><span class="nav-number">1.3.2.</span> <span class="nav-text">过分一般性</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E5%A4%8D"><span class="nav-number">1.4.</span> <span class="nav-text">重复</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AD%94%E6%B3%95%E6%95%B0"><span class="nav-number">1.4.1.</span> <span class="nav-text">魔法数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%87%8D%E5%A4%8D%E4%BB%A3%E7%A0%81"><span class="nav-number">1.4.2.</span> <span class="nav-text">重复代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B7%E6%9C%89%E4%B8%8D%E5%90%8C%E6%8E%A5%E5%8F%A3%E7%9A%84%E7%9B%B8%E4%BC%BC%E7%B1%BB"><span class="nav-number">1.4.3.</span> <span class="nav-text">具有不同接口的相似类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E9%80%BB%E8%BE%91"><span class="nav-number">1.5.</span> <span class="nav-text">条件逻辑</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Null%E6%A3%80%E6%9F%A5"><span class="nav-number">1.5.1.</span> <span class="nav-text">Null检查</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%8D%E6%9D%82%E7%9A%84%E5%B8%83%E5%B0%94%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">1.5.2.</span> <span class="nav-text">复杂的布尔表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E7%94%A8%E4%BE%8B"><span class="nav-number">1.5.3.</span> <span class="nav-text">特殊用例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A8%A1%E6%8B%9F%E7%BB%A7%E6%89%BF-switch%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.5.4.</span> <span class="nav-text">模拟继承(switch语句)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B1%BB%E4%B9%8B%E9%97%B4%E7%9A%84%E5%BC%82%E5%91%B3"><span class="nav-number">2.</span> <span class="nav-text">类之间的异味</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE"><span class="nav-number">2.1.</span> <span class="nav-text">数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%9B%B0%E6%89%B0"><span class="nav-number">2.1.1.</span> <span class="nav-text">基本类型困扰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB"><span class="nav-number">2.1.2.</span> <span class="nav-text">数据类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%B3%A5%E5%9B%A2"><span class="nav-number">2.1.3.</span> <span class="nav-text">数据泥团</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%B4%E6%97%B6%E5%AD%97%E6%AE%B5"><span class="nav-number">2.1.4.</span> <span class="nav-text">临时字段</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%A7%E6%89%BF"><span class="nav-number">2.2.</span> <span class="nav-text">继承</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%92%E6%94%B6%E7%9A%84%E9%81%97%E8%B5%A0"><span class="nav-number">2.2.1.</span> <span class="nav-text">拒收的遗赠</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E5%BD%93%E7%9A%84%E7%B4%A7%E5%AF%86%E6%80%A7"><span class="nav-number">2.2.2.</span> <span class="nav-text">不当的紧密性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%87%92%E6%83%B0%E7%B1%BB"><span class="nav-number">2.2.3.</span> <span class="nav-text">懒惰类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%81%8C%E8%B4%A3"><span class="nav-number">2.3.</span> <span class="nav-text">职责</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%9D%E6%81%8B%E6%83%85%E8%8A%82"><span class="nav-number">2.3.1.</span> <span class="nav-text">依恋情节</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E5%BD%93%E7%9A%84%E7%B4%A7%E5%AF%86%E6%80%A7-%E4%B8%80%E8%88%AC%E5%BD%A2%E5%BC%8F"><span class="nav-number">2.3.2.</span> <span class="nav-text">不当的紧密性(一般形式)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B6%88%E6%81%AF%E9%93%BE"><span class="nav-number">2.3.3.</span> <span class="nav-text">消息链</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E9%97%B4%E4%BA%BA"><span class="nav-number">2.3.4.</span> <span class="nav-text">中间人</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E6%94%B9%E5%8F%98"><span class="nav-number">2.4.</span> <span class="nav-text">相关改变</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%91%E6%95%A3%E5%BC%8F%E6%94%B9%E5%8F%98"><span class="nav-number">2.4.1.</span> <span class="nav-text">发散式改变</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%B0%E5%BC%B9%E5%BC%8F%E4%BF%AE%E6%94%B9"><span class="nav-number">2.4.2.</span> <span class="nav-text">霰弹式修改</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B9%B6%E8%A1%8C%E7%BB%A7%E6%89%BF%E4%BD%93%E7%B3%BB"><span class="nav-number">2.4.3.</span> <span class="nav-text">并行继承体系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E7%88%86%E7%82%B8"><span class="nav-number">2.4.4.</span> <span class="nav-text">组合爆炸</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%BA%93"><span class="nav-number">2.5.</span> <span class="nav-text">类库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E5%AE%8C%E5%A4%87%E7%9A%84%E7%B1%BB%E5%BA%93"><span class="nav-number">2.5.1.</span> <span class="nav-text">不完备的类库</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%87%8D%E6%9E%84%E6%8A%80%E6%B3%95"><span class="nav-number">3.</span> <span class="nav-text">重构技法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Composing-Methods%EF%BC%9A%E4%BC%98%E5%8C%96%E5%87%BD%E6%95%B0%E7%9A%84%E6%9E%84%E6%88%90"><span class="nav-number">3.1.</span> <span class="nav-text">Composing Methods：优化函数的构成</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Extract-Method%EF%BC%9A%E6%8A%BD%E5%8F%96%E6%96%B9%E6%B3%95"><span class="nav-number">3.1.1.</span> <span class="nav-text">Extract Method：抽取方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Inline-Method%EF%BC%9A%E5%86%85%E8%81%94%E6%96%B9%E6%B3%95"><span class="nav-number">3.1.2.</span> <span class="nav-text">Inline Method：内联方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Extract-Variable%EF%BC%9A%E6%8F%90%E7%82%BC%E5%8F%98%E9%87%8F"><span class="nav-number">3.1.3.</span> <span class="nav-text">Extract Variable：提炼变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Inline-Temp%EF%BC%9A%E5%86%85%E8%81%94%E4%B8%B4%E6%97%B6%E5%8F%98%E9%87%8F"><span class="nav-number">3.1.4.</span> <span class="nav-text">Inline Temp：内联临时变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Temp-with-Query%EF%BC%9A%E4%BB%A5%E6%9F%A5%E8%AF%A2%E5%8F%96%E4%BB%A3%E4%B8%B4%E6%97%B6%E5%8F%98%E9%87%8F"><span class="nav-number">3.1.5.</span> <span class="nav-text">Replace Temp with Query：以查询取代临时变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Split-Temporary-Variable%EF%BC%9A%E6%8B%86%E5%88%86%E4%B8%B4%E6%97%B6%E5%8F%98%E9%87%8F"><span class="nav-number">3.1.6.</span> <span class="nav-text">Split Temporary Variable：拆分临时变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Remove-Assignments-to-Parameters%EF%BC%9A%E7%A7%BB%E9%99%A4%E5%8F%82%E6%95%B0%E8%B5%8B%E5%80%BC"><span class="nav-number">3.1.7.</span> <span class="nav-text">Remove Assignments to Parameters：移除参数赋值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Method-with-Method-Object%EF%BC%9A%E4%BB%A5%E6%96%B9%E6%B3%95%E5%AF%B9%E8%B1%A1%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%B3%95"><span class="nav-number">3.1.8.</span> <span class="nav-text">Replace Method with Method Object：以方法对象替代方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Substitute-Algorithm%EF%BC%9A%E6%9B%BF%E6%8D%A2%E7%AE%97%E6%B3%95"><span class="nav-number">3.1.9.</span> <span class="nav-text">Substitute Algorithm：替换算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Moving-Features-between-Objects%EF%BC%9A%E5%9C%A8%E5%AF%B9%E8%B1%A1%E4%B9%8B%E9%97%B4%E6%90%AC%E7%A7%BB%E7%89%B9%E6%80%A7"><span class="nav-number">3.2.</span> <span class="nav-text">Moving Features between Objects：在对象之间搬移特性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Move-Method%EF%BC%9A%E6%90%AC%E7%A7%BB%E6%96%B9%E6%B3%95"><span class="nav-number">3.2.1.</span> <span class="nav-text">Move Method：搬移方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Move-Field%EF%BC%9A%E6%90%AC%E7%A7%BB%E5%AD%97%E6%AE%B5"><span class="nav-number">3.2.2.</span> <span class="nav-text">Move Field：搬移字段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Extract-Class%EF%BC%9A%E6%8A%BD%E5%8F%96%E7%B1%BB"><span class="nav-number">3.2.3.</span> <span class="nav-text">Extract Class：抽取类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Inline-Class%EF%BC%9A%E5%86%85%E8%81%94%E7%B1%BB"><span class="nav-number">3.2.4.</span> <span class="nav-text">Inline Class：内联类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Hide-Delegate%EF%BC%9A%E9%9A%90%E8%97%8F%E5%A7%94%E6%89%98"><span class="nav-number">3.2.5.</span> <span class="nav-text">Hide Delegate：隐藏委托</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Remove-Middle-Man%EF%BC%9A%E7%A7%BB%E9%99%A4%E4%B8%AD%E9%97%B4%E4%BA%BA"><span class="nav-number">3.2.6.</span> <span class="nav-text">Remove Middle Man：移除中间人</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Introduce-Foreign-Method%EF%BC%9A%E5%BC%95%E5%85%A5%E5%A4%96%E5%8A%A0%E5%87%BD%E6%95%B0"><span class="nav-number">3.2.7.</span> <span class="nav-text">Introduce Foreign Method：引入外加函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Introduce-Local-Extension%EF%BC%9A%E5%BC%95%E5%85%A5%E6%9C%AC%E5%9C%B0%E6%89%A9%E5%B1%95"><span class="nav-number">3.2.8.</span> <span class="nav-text">Introduce Local Extension：引入本地扩展</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Organizing-Data%EF%BC%9A%E9%87%8D%E6%96%B0%E7%BB%84%E7%BB%87%E6%95%B0%E6%8D%AE"><span class="nav-number">3.3.</span> <span class="nav-text">Organizing Data：重新组织数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Change-Value-to-Reference%EF%BC%9A%E5%B0%86%E5%80%BC%E5%AF%B9%E8%B1%A1%E6%94%B9%E4%B8%BA%E5%BC%95%E7%94%A8%E5%AF%B9%E8%B1%A1"><span class="nav-number">3.3.1.</span> <span class="nav-text">Change Value to Reference：将值对象改为引用对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Change-Reference-to-Value%EF%BC%9A%E5%B0%86%E5%BC%95%E7%94%A8%E5%AF%B9%E8%B1%A1%E6%94%B9%E4%B8%BA%E5%80%BC%E5%AF%B9%E8%B1%A1"><span class="nav-number">3.3.2.</span> <span class="nav-text">Change Reference to Value：将引用对象改为值对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Duplicate-Observed-Data%EF%BC%9A%E5%A4%8D%E5%88%B6%E8%A2%AB%E7%9B%91%E8%A7%86%E6%95%B0%E6%8D%AE"><span class="nav-number">3.3.3.</span> <span class="nav-text">Duplicate Observed Data：复制被监视数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Self-Encapsulate-Field%EF%BC%9A%E8%87%AA%E5%B0%81%E8%A3%85%E5%AD%97%E6%AE%B5"><span class="nav-number">3.3.4.</span> <span class="nav-text">Self Encapsulate Field：自封装字段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Data-Value-with-Object%EF%BC%9A%E4%BB%A5%E5%AF%B9%E8%B1%A1%E5%8F%96%E4%BB%A3%E6%95%B0%E6%8D%AE%E5%80%BC"><span class="nav-number">3.3.5.</span> <span class="nav-text">Replace Data Value with Object：以对象取代数据值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Array-with-Object%EF%BC%9A%E4%BB%A5%E5%AF%B9%E8%B1%A1%E5%8F%96%E4%BB%A3%E6%95%B0%E7%BB%84"><span class="nav-number">3.3.6.</span> <span class="nav-text">Replace Array with Object：以对象取代数组</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Change-Unidirectional-Association-to-Bidirectional%EF%BC%9A%E5%B0%86%E5%8D%95%E5%90%91%E5%85%B3%E8%81%94%E6%94%B9%E4%B8%BA%E5%8F%8C%E5%90%91"><span class="nav-number">3.3.7.</span> <span class="nav-text">Change Unidirectional Association to Bidirectional：将单向关联改为双向</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Change-Bidirectional-Association-to-Unidirectional%EF%BC%9A%E5%B0%86%E5%8F%8C%E5%90%91%E5%85%B3%E8%81%94%E6%94%B9%E4%B8%BA%E5%8D%95%E5%90%91"><span class="nav-number">3.3.8.</span> <span class="nav-text">Change Bidirectional Association to Unidirectional：将双向关联改为单向</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Encapsulate-Field%EF%BC%9A%E5%B0%81%E8%A3%85%E5%AD%97%E6%AE%B5"><span class="nav-number">3.3.9.</span> <span class="nav-text">Encapsulate Field：封装字段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Encapsulate-Collection%EF%BC%9A%E5%B0%81%E8%A3%85%E9%9B%86%E5%90%88"><span class="nav-number">3.3.10.</span> <span class="nav-text">Encapsulate Collection：封装集合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Magic-Number-with-Symbolic-Constant%EF%BC%9A%E4%BB%A5%E7%AC%A6%E5%8F%B7%E5%B8%B8%E9%87%8F%E5%8F%96%E4%BB%A3%E9%AD%94%E6%B3%95%E6%95%B0"><span class="nav-number">3.3.11.</span> <span class="nav-text">Replace Magic Number with Symbolic Constant：以符号常量取代魔法数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Type-Code-with-Class%EF%BC%9A%E4%BB%A5%E7%B1%BB%E5%8F%96%E4%BB%A3%E7%B1%BB%E5%9E%8B%E7%A0%81"><span class="nav-number">3.3.12.</span> <span class="nav-text">Replace Type Code with Class：以类取代类型码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Type-Code-with-Subclasses%EF%BC%9A%E4%BB%A5%E5%AD%90%E7%B1%BB%E5%8F%96%E4%BB%A3%E7%B1%BB%E5%9E%8B%E7%A0%81"><span class="nav-number">3.3.13.</span> <span class="nav-text">Replace Type Code with Subclasses：以子类取代类型码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Type-Code-with-State-Strategy%EF%BC%9A%E4%BB%A5%E7%8A%B6%E6%80%81-%E7%AD%96%E7%95%A5%E5%8F%96%E4%BB%A3%E7%B1%BB%E5%9E%8B%E7%A0%81"><span class="nav-number">3.3.14.</span> <span class="nav-text">Replace Type Code with State&#x2F;Strategy：以状态&#x2F;策略取代类型码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Subclass-with-Fields%EF%BC%9A%E4%BB%A5%E5%AD%97%E6%AE%B5%E5%8F%96%E4%BB%A3%E5%AD%90%E7%B1%BB"><span class="nav-number">3.3.15.</span> <span class="nav-text">Replace Subclass with Fields：以字段取代子类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Simplifying-Conditional-Expressions%EF%BC%9A%E7%AE%80%E5%8C%96%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">3.4.</span> <span class="nav-text">Simplifying Conditional Expressions：简化条件表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Consolidate-Conditional-Expression%EF%BC%9A%E5%90%88%E5%B9%B6%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">3.4.1.</span> <span class="nav-text">Consolidate Conditional Expression：合并条件表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Consolidate-Duplicate-Conditional-Fragments%EF%BC%9A%E5%90%88%E5%B9%B6%E9%87%8D%E5%A4%8D%E6%9D%A1%E4%BB%B6%E7%89%87%E6%96%AD"><span class="nav-number">3.4.2.</span> <span class="nav-text">Consolidate Duplicate Conditional Fragments：合并重复条件片断</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Decompose-Conditional%EF%BC%9A%E5%88%86%E8%A7%A3%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">3.4.3.</span> <span class="nav-text">Decompose Conditional：分解条件表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Conditional-with-Polymorphism%EF%BC%9A%E4%BB%A5%E5%A4%9A%E6%80%81%E5%8F%96%E4%BB%A3%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">3.4.4.</span> <span class="nav-text">Replace Conditional with Polymorphism：以多态取代条件表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Remove-Control-Flag%EF%BC%9A%E7%A7%BB%E9%99%A4%E6%8E%A7%E5%88%B6%E6%A0%87%E8%AE%B0"><span class="nav-number">3.4.5.</span> <span class="nav-text">Remove Control Flag：移除控制标记</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Nested-Conditional-with-Guard-Clauses%EF%BC%9A%E4%BB%A5%E5%8D%AB%E8%AF%AD%E5%8F%A5%E5%8F%96%E4%BB%A3%E5%B5%8C%E5%A5%97%E6%9D%A1%E4%BB%B6%E5%BC%8F"><span class="nav-number">3.4.6.</span> <span class="nav-text">Replace Nested Conditional with Guard Clauses：以卫语句取代嵌套条件式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Introduce-Null-Object%EF%BC%9A%E5%BC%95%E5%85%A5Null%E5%AF%B9%E8%B1%A1"><span class="nav-number">3.4.7.</span> <span class="nav-text">Introduce Null Object：引入Null对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Introduce-Assertion%EF%BC%9A%E5%BC%95%E5%85%A5%E6%96%AD%E8%A8%80"><span class="nav-number">3.4.8.</span> <span class="nav-text">Introduce Assertion：引入断言</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Simplifying-Method-Calls%EF%BC%9A%E7%AE%80%E5%8C%96%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8"><span class="nav-number">3.5.</span> <span class="nav-text">Simplifying Method Calls：简化方法调用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Add-Parameter%EF%BC%9A%E6%B7%BB%E5%8A%A0%E5%8F%82%E6%95%B0"><span class="nav-number">3.5.1.</span> <span class="nav-text">Add Parameter：添加参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Remove-Parameter%EF%BC%9A%E7%A7%BB%E9%99%A4%E5%8F%82%E6%95%B0"><span class="nav-number">3.5.2.</span> <span class="nav-text">Remove Parameter：移除参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Rename-Method%EF%BC%9A%E9%87%8D%E5%91%BD%E5%90%8D%E6%96%B9%E6%B3%95"><span class="nav-number">3.5.3.</span> <span class="nav-text">Rename Method：重命名方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Separate-Query-from-Modifier%EF%BC%9A%E5%B0%86%E6%9F%A5%E8%AF%A2%E6%96%B9%E6%B3%95%E5%92%8C%E4%BF%AE%E6%94%B9%E6%96%B9%E6%B3%95%E5%88%86%E7%A6%BB"><span class="nav-number">3.5.4.</span> <span class="nav-text">Separate Query from Modifier：将查询方法和修改方法分离</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Parameterize-Method%EF%BC%9A%E8%AE%A9%E6%96%B9%E6%B3%95%E6%90%BA%E5%B8%A6%E5%8F%82%E6%95%B0"><span class="nav-number">3.5.5.</span> <span class="nav-text">Parameterize Method：让方法携带参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Introduce-Parameter-Object%EF%BC%9A%E5%BC%95%E5%85%A5%E5%8F%82%E6%95%B0%E5%AF%B9%E8%B1%A1"><span class="nav-number">3.5.6.</span> <span class="nav-text">Introduce Parameter Object：引入参数对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Preserve-Whole-Object%EF%BC%9A%E4%BF%9D%E6%8C%81%E5%AF%B9%E8%B1%A1%E5%AE%8C%E6%95%B4"><span class="nav-number">3.5.7.</span> <span class="nav-text">Preserve Whole Object：保持对象完整</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Remove-Setting-Method%EF%BC%9A%E7%A7%BB%E9%99%A4%E8%AE%BE%E5%80%BC%E6%96%B9%E6%B3%95"><span class="nav-number">3.5.8.</span> <span class="nav-text">Remove Setting Method：移除设值方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Parameter-with-Explicit-Methods%EF%BC%9A%E4%BB%A5%E6%98%8E%E7%A1%AE%E5%87%BD%E6%95%B0%E5%8F%96%E4%BB%A3%E5%8F%82%E6%95%B0"><span class="nav-number">3.5.9.</span> <span class="nav-text">Replace Parameter with Explicit Methods：以明确函数取代参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Parameter-with-Method-Call%EF%BC%9A%E4%BB%A5%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E5%8F%96%E4%BB%A3%E5%8F%82%E6%95%B0"><span class="nav-number">3.5.10.</span> <span class="nav-text">Replace Parameter with Method Call：以函数调用取代参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Hide-Method%EF%BC%9A%E9%9A%90%E8%97%8F%E6%96%B9%E6%B3%95"><span class="nav-number">3.5.11.</span> <span class="nav-text">Hide Method：隐藏方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Constructor-with-Factory-Method%EF%BC%9A%E4%BB%A5%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E5%8F%96%E4%BB%A3%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="nav-number">3.5.12.</span> <span class="nav-text">Replace Constructor with Factory Method：以工厂方法取代构造函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Error-Code-with-Exception%EF%BC%9A%E4%BB%A5%E5%BC%82%E5%B8%B8%E5%8F%96%E4%BB%A3%E9%94%99%E8%AF%AF%E7%A0%81"><span class="nav-number">3.5.13.</span> <span class="nav-text">Replace Error Code with Exception：以异常取代错误码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Exception-with-Test%EF%BC%9A%E4%BB%A5%E6%B5%8B%E8%AF%95%E5%8F%96%E4%BB%A3%E5%BC%82%E5%B8%B8"><span class="nav-number">3.5.14.</span> <span class="nav-text">Replace Exception with Test：以测试取代异常</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pull-Up-Field%EF%BC%9A%E4%B8%8A%E7%A7%BB%E5%AD%97%E6%AE%B5"><span class="nav-number">3.5.15.</span> <span class="nav-text">Pull Up Field：上移字段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pull-Up-Method%EF%BC%9A%E4%B8%8A%E7%A7%BB%E6%96%B9%E6%B3%95"><span class="nav-number">3.5.16.</span> <span class="nav-text">Pull Up Method：上移方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pull-Up-Constructor-Body%EF%BC%9A%E4%B8%8A%E7%A7%BB%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%9C%AC%E4%BD%93"><span class="nav-number">3.5.17.</span> <span class="nav-text">Pull Up Constructor Body：上移构造函数本体</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dealing-with-Generalization%EF%BC%9A%E5%A4%84%E7%90%86%E6%A6%82%E6%8B%AC%E5%85%B3%E7%B3%BB"><span class="nav-number">3.6.</span> <span class="nav-text">Dealing with Generalization：处理概括关系</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Push-Down-Field%EF%BC%9A%E4%B8%8B%E7%A7%BB%E5%AD%97%E6%AE%B5"><span class="nav-number">3.6.1.</span> <span class="nav-text">Push Down Field：下移字段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Push-Down-Method%EF%BC%9A%E4%B8%8B%E7%A7%BB%E6%96%B9%E6%B3%95"><span class="nav-number">3.6.2.</span> <span class="nav-text">Push Down Method：下移方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Extract-Subclass%EF%BC%9A%E6%8A%BD%E5%8F%96%E5%AD%90%E7%B1%BB"><span class="nav-number">3.6.3.</span> <span class="nav-text">Extract Subclass：抽取子类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Extract-Superclass%EF%BC%9A%E6%8A%BD%E5%8F%96%E8%B6%85%E7%B1%BB"><span class="nav-number">3.6.4.</span> <span class="nav-text">Extract Superclass：抽取超类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Extract-Interface%EF%BC%9A%E6%8A%BD%E5%8F%96%E6%8E%A5%E5%8F%A3"><span class="nav-number">3.6.5.</span> <span class="nav-text">Extract Interface：抽取接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Collapse-Hierarchy%EF%BC%9A%E6%8A%98%E5%8F%A0%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB"><span class="nav-number">3.6.6.</span> <span class="nav-text">Collapse Hierarchy：折叠继承关系</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Form-Template-Method%EF%BC%9A%E5%A1%91%E9%80%A0%E6%A8%A1%E6%9D%BF%E5%87%BD%E6%95%B0"><span class="nav-number">3.6.7.</span> <span class="nav-text">Form Template Method：塑造模板函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Inheritance-with-Delegation%EF%BC%9A%E4%BB%A5%E5%A7%94%E6%89%98%E5%8F%96%E4%BB%A3%E7%BB%A7%E6%89%BF"><span class="nav-number">3.6.8.</span> <span class="nav-text">Replace Inheritance with Delegation：以委托取代继承</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Replace-Delegation-with-Inheritance%EF%BC%9A%E4%BB%A5%E7%BB%A7%E6%89%BF%E5%8F%96%E4%BB%A3%E5%A7%94%E6%89%98"><span class="nav-number">3.6.9.</span> <span class="nav-text">Replace Delegation with Inheritance：以继承取代委托</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">4.</span> <span class="nav-text">参考</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jay.Run</p>
  <div class="site-description" itemprop="description">学习 思考 行动 Python</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">169</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">87</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ruanimal" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ruanimal" rel="noopener me" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://leetcode-cn.com/u/iponder" title="Leetcode → https:&#x2F;&#x2F;leetcode-cn.com&#x2F;u&#x2F;iponder" rel="noopener me" target="_blank"><i class="cubes fa-fw"></i>Leetcode</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://www.liaoxuefeng.com/" title="https:&#x2F;&#x2F;www.liaoxuefeng.com&#x2F;" rel="noopener" target="_blank">廖雪峰的官方网站</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="http://www.ruanyifeng.com/" title="http:&#x2F;&#x2F;www.ruanyifeng.com&#x2F;" rel="noopener" target="_blank">阮一峰的个人网站</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://cse.google.com/cse?cx=006975008861986536211:lpx3qasaiom" title="https:&#x2F;&#x2F;cse.google.com&#x2F;cse?cx&#x3D;006975008861986536211:lpx3qasaiom" rel="noopener" target="_blank">mac软件搜索引擎</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://blog.kaciras.com/" title="https:&#x2F;&#x2F;blog.kaciras.com&#x2F;" rel="noopener" target="_blank">Kaciras' Blog</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.ponder.work/2020/10/15/%E5%AD%A6%E4%B9%A0%E3%80%8A%E9%87%8D%E6%9E%84%E6%89%8B%E5%86%8C%E3%80%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jay.Run">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="逸思杂陈">
      <meta itemprop="description" content="学习 思考 行动 Python">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="学习《重构手册》 | 逸思杂陈">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          学习《重构手册》
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-10-15 21:48:00" itemprop="dateCreated datePublished" datetime="2020-10-15T21:48:00+08:00">2020-10-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-07-09 22:02:56" itemprop="dateModified" datetime="2024-07-09T22:02:56+08:00">2024-07-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/programming/" itemprop="url" rel="index"><span itemprop="name">编程</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>7.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>28 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p><img src="https://image.ponder.work/mweb/2020-10-18-%E9%87%8D%E6%9E%84%E6%89%8B%E5%86%8C-%E5%BC%82%E5%91%B3.png"></p>
<span id="more"></span>

<style type="text/css">
    .fancybox {
        display: inline-block;
        border-bottom: 0;
    }
    img[alt="before"] {
        width: 350px;
        height: 600px;
        object-fit: contain;
    }
    img[alt="after"] {
        width: 350px;
        height: 600px;
        object-fit: contain;
    }
</style>

<h2 id="类中的异味"><a href="#类中的异味" class="headerlink" title="类中的异味"></a>类中的异味</h2><h3 id="可度量的异味"><a href="#可度量的异味" class="headerlink" title="可度量的异味"></a>可度量的异味</h3><h4 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h4><p><strong>症状</strong></p>
<ul>
<li>代码中出现注释</li>
</ul>
<p><strong>原因</strong><br>作者认为某些内容没有说清楚</p>
<ul>
<li>采用某种做法的原因</li>
<li>某种复杂的算法的实现</li>
</ul>
<p><strong>措施</strong></p>
<ul>
<li>对一个代码块的注释：<a href="#Extract-Method%EF%BC%9A%E6%8A%BD%E5%8F%96%E6%96%B9%E6%B3%95">抽取方法</a>，并用注释为新方法取名</li>
<li>对方法所做工作的注释：<a href="#Rename-Method%EF%BC%9A%E9%87%8D%E5%91%BD%E5%90%8D%E6%96%B9%E6%B3%95">重命名方法</a>，用注释为方法重命名</li>
<li>注释描述的是前提条件或边界：<a href="#Introduce-Assertion%EF%BC%9A%E5%BC%95%E5%85%A5%E6%96%AD%E8%A8%80">引入断言</a></li>
</ul>
<p><strong>收益</strong><br>可以增强表述能力，有可能暴露出重复性</p>
<p><strong>例外</strong><br>有些注释是必要的，比如需求文档的链接</p>
<h4 id="过长的方法"><a href="#过长的方法" class="headerlink" title="过长的方法"></a>过长的方法</h4><p><strong>症状</strong></p>
<ul>
<li>代码块行数很多（个人感觉超过屏幕的高度为多）</li>
</ul>
<p><strong>原因</strong><br>没有及时分解代码块，只是一味地在原来的位置增加代码</p>
<p><strong>措施</strong></p>
<ul>
<li>根据代码块的注释和空行和空格，分析前后语义，<a href="#Extract-Method%EF%BC%9A%E6%8A%BD%E5%8F%96%E6%96%B9%E6%B3%95">抽取方法</a>。</li>
<li>找到一些重构技术，用于清理直线式代码（ 即大量代码都放在一行上） 、条件式和变量</li>
</ul>
<p><strong>收益</strong><br>可以增强表述能力，有可能暴露出重复性，通常有助于建立新的类和抽象。</p>
<p><strong>例外</strong><br>有些复杂的算法需求，天然需求很多行</p>
<h4 id="过大的类"><a href="#过大的类" class="headerlink" title="过大的类"></a>过大的类</h4><p><strong>症状</strong></p>
<ul>
<li>代码行数很多</li>
<li>大量实例变量</li>
<li>大量方法</li>
</ul>
<p><strong>原因</strong><br>没有及时根据职责拆分类，只是一味地在原来的类上增加代码。</p>
<p><strong>措施</strong></p>
<ul>
<li>优先解决过长的方法</li>
<li>一个新类能承担此类部分职责, <a href="#Extract-Class%EF%BC%9A%E6%8A%BD%E5%8F%96%E7%B1%BB">抽取类</a></li>
<li>可以划分类和新子类之间的功能的话, <a href="#Extract-Subclass%EF%BC%9A%E6%8A%BD%E5%8F%96%E5%AD%90%E7%B1%BB">抽取子类</a></li>
<li>可以确定客户所用的特性子集, <a href="#Extract-Interface%EF%BC%9A%E6%8A%BD%E5%8F%96%E6%8E%A5%E5%8F%A3">抽取接口</a></li>
</ul>
<p><strong>收益</strong><br>可以增强表述能力，有可能暴露出重复性</p>
<p><strong>例外</strong><br>无</p>
<h4 id="过长的参数表"><a href="#过长的参数表" class="headerlink" title="过长的参数表"></a>过长的参数表</h4><p><strong>症状</strong></p>
<ul>
<li>方法有1个或2个以上的参数（个人觉得3个以上）</li>
</ul>
<p><strong>原因</strong><br>可能是为了尽量减少对象之间的耦合。这样做不是由被调用对象来了解类之间的关系，而是让调用者来确定所有一切。<br>也有可能是程序员对例程进行了通用化</p>
<p><strong>措施</strong></p>
<ul>
<li>参数可由已知对象得到：<a href="#Replace-Parameter-with-Method-Call%EF%BC%9A%E4%BB%A5%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E5%8F%96%E4%BB%A3%E5%8F%82%E6%95%B0">参数替换为方法</a>（调用方法获取该参数）</li>
<li>参数来自一个对象：<a href="#Preserve-Whole-Object%EF%BC%9A%E4%BF%9D%E6%8C%81%E5%AF%B9%E8%B1%A1%E5%AE%8C%E6%95%B4">保持对象完整</a>（传递完整对象作为参数）</li>
<li>数据不是来自一个逻辑对象：<a href="#Introduce-Parameter-Object%EF%BC%9A%E5%BC%95%E5%85%A5%E5%8F%82%E6%95%B0%E5%AF%B9%E8%B1%A1">引入参数对象</a>，将其分组（将长参数表变为少量参数对象）</li>
</ul>
<p><strong>收益</strong><br>可以增强表述能力，有可能暴露出重复性。通常可以缩小规模。</p>
<p><strong>例外</strong></p>
<ul>
<li>不希望两个类出现依赖</li>
<li>参数不存在有意义的分组</li>
</ul>
<h3 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h3><h4 id="名字中包含类型"><a href="#名字中包含类型" class="headerlink" title="名字中包含类型"></a>名字中包含类型</h4><p><strong>症状</strong></p>
<ul>
<li>名字采用复合词，包含类型信息</li>
<li>匈牙利记法，如iCount</li>
<li>变量名反映的是类型，而不是其用途</li>
</ul>
<p><strong>原因</strong></p>
<ul>
<li>没有ide的时代，命令包含类型增加了可读性</li>
</ul>
<p><strong>措施</strong></p>
<ul>
<li><a href="#Rename-Method%EF%BC%9A%E9%87%8D%E5%91%BD%E5%90%8D%E6%96%B9%E6%B3%95">重命名方法</a></li>
<li>重命名字段</li>
</ul>
<p><strong>收益</strong><br>可以增强表述能力，有可能暴露出重复性</p>
<p><strong>例外</strong><br>有些场景命名中的类型是有帮助的，如sql的字段</p>
<h4 id="表达力差的名字"><a href="#表达力差的名字" class="headerlink" title="表达力差的名字"></a>表达力差的名字</h4><p><strong>症状</strong></p>
<ul>
<li>单字符或双字符</li>
<li>无元音的名字</li>
<li>带编号的变量，如panel1，panel2</li>
<li>奇怪的缩写</li>
<li>容易误导的名称</li>
</ul>
<p><strong>原因</strong><br>取名没有规范，过于随意</p>
<p><strong>措施</strong></p>
<ul>
<li><a href="#Rename-Method%EF%BC%9A%E9%87%8D%E5%91%BD%E5%90%8D%E6%96%B9%E6%B3%95">重命名方法</a></li>
<li>重命名字段</li>
</ul>
<p><strong>收益</strong><br>可以增强表述能力</p>
<p><strong>例外</strong></p>
<ul>
<li>i,j,k等循环变量</li>
<li>只在几行代码中起作用的单字符变量</li>
<li>函数的多个版本实现</li>
</ul>
<h4 id="不一致的名字"><a href="#不一致的名字" class="headerlink" title="不一致的名字"></a>不一致的名字</h4><p><strong>症状</strong></p>
<ul>
<li>同一个对象却有多个名字</li>
</ul>
<p><strong>原因</strong><br>不同的人会在不同时刻创建类, 但作用是相同的, 导致名称不一样</p>
<p><strong>措施</strong></p>
<ul>
<li><a href="#Rename-Method%EF%BC%9A%E9%87%8D%E5%91%BD%E5%90%8D%E6%96%B9%E6%B3%95">重命名方法</a></li>
<li>重命名字段</li>
</ul>
<p><strong>收益</strong><br>可以增强表述能力, 有可能暴露出重复性</p>
<p><strong>例外</strong><br>无</p>
<h3 id="不必要的复杂性"><a href="#不必要的复杂性" class="headerlink" title="不必要的复杂性"></a>不必要的复杂性</h3><h4 id="死代码"><a href="#死代码" class="headerlink" title="死代码"></a>死代码</h4><p><strong>症状</strong></p>
<ul>
<li>变量、参数、字段、代码段、方法或类未在任何地方使用(除了测试)</li>
</ul>
<p><strong>原因</strong></p>
<ul>
<li>需求变更, 或采用了新方法, 未充分清理</li>
<li>简化代码时未发现冗余的逻辑</li>
</ul>
<p><strong>措施</strong></p>
<ul>
<li>删除相关代码并测试</li>
</ul>
<p><strong>收益</strong><br>降低规模。可以增强表述能力，代码更简单。</p>
<p><strong>例外</strong></p>
<ul>
<li>为子类或者调用方提供的hook等方法</li>
</ul>
<h4 id="过分一般性"><a href="#过分一般性" class="headerlink" title="过分一般性"></a>过分一般性</h4><p><strong>症状</strong></p>
<ul>
<li>未使用的变量、参数、字段、代码段、方法或类; 没有实际作用的继承体系和调用链</li>
<li>就当前需求来说, 代码实现过于复杂</li>
</ul>
<p><strong>原因</strong></p>
<ul>
<li>预先设计, 但是实际需求并没有用到该设计, 或者不符合该设计</li>
</ul>
<p><strong>措施</strong></p>
<ul>
<li>不必要的类: <a href="#Collapse-Hierarchy%EF%BC%9A%E6%8A%98%E5%8F%A0%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB">折叠继承关系</a>, <a href="#Inline-Class%EF%BC%9A%E5%86%85%E8%81%94%E7%B1%BB">内联类</a></li>
<li>不必要的方法: <a href="#Inline-Method%EF%BC%9A%E5%86%85%E8%81%94%E6%96%B9%E6%B3%95">内联方法</a>, 移除方法</li>
<li>不必要的字段: 删除</li>
<li>不必要的参数: <a href="#Remove-Parameter%EF%BC%9A%E7%A7%BB%E9%99%A4%E5%8F%82%E6%95%B0">移除参数</a></li>
</ul>
<p><strong>收益</strong><br>降低规模。可以增强表述能力，代码更简单。</p>
<p><strong>例外</strong></p>
<ul>
<li>框架代码</li>
<li>为测试提供的接口</li>
</ul>
<h3 id="重复"><a href="#重复" class="headerlink" title="重复"></a>重复</h3><h4 id="魔法数"><a href="#魔法数" class="headerlink" title="魔法数"></a>魔法数</h4><p><strong>症状</strong></p>
<ul>
<li>代码里出现了数值常量或者字符串常量</li>
</ul>
<p><strong>原因</strong></p>
<ul>
<li>第一次添加常量时, 错误地认为该常量只会在该处使用</li>
</ul>
<p><strong>措施</strong></p>
<ul>
<li>特殊值: <a href="#Replace-Magic-Number-with-Symbolic-Constant%EF%BC%9A%E4%BB%A5%E7%AC%A6%E5%8F%B7%E5%B8%B8%E9%87%8F%E5%8F%96%E4%BB%A3%E9%AD%94%E6%B3%95%E6%95%B0">以符号常量取代魔法数</a></li>
<li>可根据规则生成: 替换为函数</li>
</ul>
<p><strong>收益</strong><br>减少重复。可以增强表述能力，代码更简单。</p>
<p><strong>例外</strong></p>
<ul>
<li>为了提高测试代码的可读性</li>
</ul>
<h4 id="重复代码"><a href="#重复代码" class="headerlink" title="重复代码"></a>重复代码</h4><p><strong>症状</strong></p>
<ul>
<li>简单形式: 代码实现几乎相同</li>
<li>复杂形式: 代码作用几乎相同</li>
</ul>
<p><strong>原因</strong></p>
<ul>
<li>不同的程序员独立开发产生</li>
<li>懒惰, 常见于不愿意理解原代码的逻辑, 直接复制原代码少量修改</li>
</ul>
<p><strong>措施</strong></p>
<ul>
<li>两段代码部分重复: <a href="#Extract-Method%EF%BC%9A%E6%8A%BD%E5%8F%96%E6%96%B9%E6%B3%95">抽取方法</a></li>
<li>兄弟类之间的重复: 抽取公共部分, <a href="#Pull-Up-Field%EF%BC%9A%E4%B8%8A%E7%A7%BB%E5%AD%97%E6%AE%B5">上移字段</a>或<a href="#Pull-Up-Method%EF%BC%9A%E4%B8%8A%E7%A7%BB%E6%96%B9%E6%B3%95">上移方法</a></li>
<li>无关类之间的重复: 采用<a href="#Extract-Class%EF%BC%9A%E6%8A%BD%E5%8F%96%E7%B1%BB">抽取类</a>, 抽取公共部分</li>
<li>重复代码不完全相同: 采用替代算法</li>
</ul>
<p><strong>收益</strong><br>减少重复, 降低规模，代码更简单。</p>
<p><strong>例外</strong></p>
<ul>
<li>重复代码可读性更好</li>
<li>只是恰好实现相同, 代码的作用并没有什么关系</li>
</ul>
<h4 id="具有不同接口的相似类"><a href="#具有不同接口的相似类" class="headerlink" title="具有不同接口的相似类"></a>具有不同接口的相似类</h4><p><strong>症状</strong></p>
<ul>
<li>两个类的作用似乎相同, 但是使用了不同的方法名</li>
</ul>
<p><strong>原因</strong></p>
<ul>
<li>开发代码时, 没有注意到已有类似代码</li>
</ul>
<p><strong>措施</strong><br>协调各个类, 使他们一致, 从而去除其中一个</p>
<ol>
<li>采用<a href="#Rename-Method%EF%BC%9A%E9%87%8D%E5%91%BD%E5%90%8D%E6%96%B9%E6%B3%95">重命名方法</a>使方法名类似。</li>
<li>使用<a href="#Move-Method%EF%BC%9A%E6%90%AC%E7%A7%BB%E6%96%B9%E6%B3%95">搬移方法</a>、<a href="#Add-Parameter%EF%BC%9A%E6%B7%BB%E5%8A%A0%E5%8F%82%E6%95%B0">添加参数</a>和令方法参数化来使协议（即方法签名和实现途径）类似。</li>
<li>如果两个类只是相似而并非相同，在对它们进行合理协调后，可<a href="#Extract-Superclass%EF%BC%9A%E6%8A%BD%E5%8F%96%E8%B6%85%E7%B1%BB">抽取超类</a></li>
<li>尽量删除多余的类</li>
</ol>
<p><strong>收益</strong><br>减少重复, 降低规模，可能增强表述能力。</p>
<p><strong>例外</strong></p>
<ul>
<li>有时这些类无法修改, 比如在不同的库中</li>
</ul>
<h3 id="条件逻辑"><a href="#条件逻辑" class="headerlink" title="条件逻辑"></a>条件逻辑</h3><h4 id="Null检查"><a href="#Null检查" class="headerlink" title="Null检查"></a>Null检查</h4><p><strong>症状</strong></p>
<ul>
<li>反复出现Null检查代码</li>
</ul>
<p><strong>原因</strong></p>
<ul>
<li>没有正确初始化对象和设置默认值</li>
</ul>
<p><strong>措施</strong></p>
<ul>
<li>采用默认值</li>
<li><a href="#Introduce-Null-Object%EF%BC%9A%E5%BC%95%E5%85%A5Null%E5%AF%B9%E8%B1%A1">引入Null对象</a></li>
</ul>
<p><strong>收益</strong><br>减少重复, 减少逻辑错误。</p>
<p><strong>例外</strong></p>
<ul>
<li>只出现一次的Null检查</li>
<li>Null对象的方法必须实现安全且符合逻辑的行为</li>
<li>Null有多种含义</li>
</ul>
<h4 id="复杂的布尔表达式"><a href="#复杂的布尔表达式" class="headerlink" title="复杂的布尔表达式"></a>复杂的布尔表达式</h4><p><strong>症状</strong></p>
<ul>
<li>复杂的and, or, not表达式</li>
</ul>
<p><strong>原因</strong></p>
<ul>
<li>复杂的业务逻辑</li>
<li>逻辑多次修改叠加</li>
</ul>
<p><strong>措施</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%BE%B7%E6%91%A9%E6%A0%B9%E5%AE%9A%E5%BE%8B">DeMorgan法则</a>化简逻辑</li>
<li>引入解释变量</li>
<li><a href="#Replace-Nested-Conditional-with-Guard-Clauses%EF%BC%9A%E4%BB%A5%E5%8D%AB%E8%AF%AD%E5%8F%A5%E5%8F%96%E4%BB%A3%E5%B5%8C%E5%A5%97%E6%9D%A1%E4%BB%B6%E5%BC%8F">以卫语句取代嵌套条件式</a>, 提前剔除某些条件</li>
<li><a href="#Decompose-Conditional%EF%BC%9A%E5%88%86%E8%A7%A3%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F">分解条件表达式</a>将各个部分置于它自己的方法中。</li>
</ul>
<p><strong>收益</strong><br>可能增强表述能力</p>
<p><strong>例外</strong></p>
<ul>
<li>某些本质上复杂的逻辑, 改善不大</li>
</ul>
<h4 id="特殊用例"><a href="#特殊用例" class="headerlink" title="特殊用例"></a>特殊用例</h4><p><strong>症状</strong></p>
<ul>
<li>复杂的if语句</li>
<li>在工作前某些特定值的检查</li>
</ul>
<p><strong>原因</strong><br>没有对要判断的对象进行很好的分析和抽象</p>
<p><strong>措施</strong></p>
<ul>
<li>条件式替换为多态</li>
<li>如果过个if子句的内容类似, 修改语句使之适用于多种情况(用变量控制不同的部分)</li>
</ul>
<p><strong>收益</strong><br>可以增强表述能力, 可能暴露重复性问题</p>
<p><strong>例外</strong></p>
<ul>
<li>递归代码的退出判断</li>
<li>有时if子句反而是最简单的</li>
</ul>
<h4 id="模拟继承-switch语句"><a href="#模拟继承-switch语句" class="headerlink" title="模拟继承(switch语句)"></a>模拟继承(switch语句)</h4><p><strong>症状</strong></p>
<ul>
<li>switch语句</li>
<li>多条if, elif</li>
<li>instanceof类型判断</li>
</ul>
<p><strong>原因</strong><br>懒得引入类型</p>
<p><strong>措施</strong><br>相同条件的switch语句多处出现</p>
<ol>
<li><a href="#Extract-Method%EF%BC%9A%E6%8A%BD%E5%8F%96%E6%96%B9%E6%B3%95">抽取方法</a>。抽出每个分支的代码</li>
<li><a href="#Move-Method%EF%BC%9A%E6%90%AC%E7%A7%BB%E6%96%B9%E6%B3%95">搬移方法</a>。将相关代码搬移至适当的类</li>
<li><a href="#Replace-Type-Code-with-Subclasses%EF%BC%9A%E4%BB%A5%E5%AD%90%E7%B1%BB%E5%8F%96%E4%BB%A3%E7%B1%BB%E5%9E%8B%E7%A0%81">以子类取代类型码</a>或<a href="#Replace-Type-Code-with-State/Strategy%EF%BC%9A%E4%BB%A5%E7%8A%B6%E6%80%81/%E7%AD%96%E7%95%A5%E5%8F%96%E4%BB%A3%E7%B1%BB%E5%9E%8B%E7%A0%81">以状态&#x2F;策略取代类型码</a>。建立继承体系结构</li>
<li><a href="#Replace-Conditional-with-Polymorphism%EF%BC%9A%E4%BB%A5%E5%A4%9A%E6%80%81%E5%8F%96%E4%BB%A3%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F">以多态取代条件表达式</a>, 去除条件式</li>
</ol>
<p>如果条件式出现在一个单独的类中，可以通过将参数替换为显式方法或<a href="#Introduce-Null-Object%EF%BC%9A%E5%BC%95%E5%85%A5Null%E5%AF%B9%E8%B1%A1">引入Null对象</a>来取代条件逻辑。</p>
<p><strong>收益</strong><br>可以增强表述能力, 可能暴露重复性问题</p>
<p><strong>例外</strong></p>
<ul>
<li>仅出现一次的switch</li>
<li>工厂方法的switch</li>
</ul>
<h2 id="类之间的异味"><a href="#类之间的异味" class="headerlink" title="类之间的异味"></a>类之间的异味</h2><h3 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h3><h4 id="基本类型困扰"><a href="#基本类型困扰" class="headerlink" title="基本类型困扰"></a>基本类型困扰</h4><p><strong>症状</strong></p>
<ul>
<li>使用了基本类型或接近基本类型的类型（int,float,String,等等）</li>
<li>存在表示小整数的常量和枚举</li>
<li>存在表示字段名的字符串常量</li>
</ul>
<p><strong>原因</strong><br>当ArrayList(或其他一些通用结构）被滥用时，会出现这类紧密相关问题。</p>
<ul>
<li>没有使用类</li>
<li>模拟类型</li>
<li>模拟字段访问函数</li>
</ul>
<p><strong>措施</strong><br>对于缺失对象</p>
<ul>
<li>参见的”数据泥团”，解决数据泥团问题后通常可以封装基本类型。</li>
<li>通过<a href="#Replace-Data-Value-with-Object%EF%BC%9A%E4%BB%A5%E5%AF%B9%E8%B1%A1%E5%8F%96%E4%BB%A3%E6%95%B0%E6%8D%AE%E5%80%BC">以对象取代数据值</a>，建立首类（first-class)数据值。</li>
</ul>
<p>对于模拟类型，一个整型类型码对应一个类</p>
<ul>
<li>对于该类型码，如果行为没有条件，则它更像是一个枚举，因此可以<a href="#Replace-Type-Code-with-Class%EF%BC%9A%E4%BB%A5%E7%B1%BB%E5%8F%96%E4%BB%A3%E7%B1%BB%E5%9E%8B%E7%A0%81">以类取代类型码</a>。</li>
<li>如果此类型码是不可变的，而且该类还没有子类，则将<a href="#Replace-Type-Code-with-Subclasses%EF%BC%9A%E4%BB%A5%E5%AD%90%E7%B1%BB%E5%8F%96%E4%BB%A3%E7%B1%BB%E5%9E%8B%E7%A0%81">以子类取代类型码</a>。</li>
<li>如果类型码改变，或者类已经有子类了，就<a href="#Replace-Type-Code-with-State/Strategy%EF%BC%9A%E4%BB%A5%E7%8A%B6%E6%80%81/%E7%AD%96%E7%95%A5%E5%8F%96%E4%BB%A3%E7%B1%BB%E5%9E%8B%E7%A0%81">以状态&#x2F;策略取代类型码</a></li>
</ul>
<p>对于模拟字段访问函数</p>
<ul>
<li>如果基本类型专门用于处理某些数组元素，<a href="#Replace-Array-with-Object%EF%BC%9A%E4%BB%A5%E5%AF%B9%E8%B1%A1%E5%8F%96%E4%BB%A3%E6%95%B0%E7%BB%84">以对象取代数组</a>。</li>
</ul>
<p><strong>收益</strong><br>可以增强表述能力, 可能暴露重复性问题, 通常能表明还需要使用其他重构技术。</p>
<p><strong>例外</strong></p>
<ul>
<li>对象替换基本类型, 会增加开销</li>
</ul>
<h4 id="数据类"><a href="#数据类" class="headerlink" title="数据类"></a>数据类</h4><p><strong>症状</strong></p>
<ul>
<li>类只包含数据成员</li>
</ul>
<p><strong>原因</strong><br>类还未重复开发, 还没有抽象出行为</p>
<p><strong>措施</strong></p>
<ol>
<li>使用<a href="#Encapsulate-Field%EF%BC%9A%E5%B0%81%E8%A3%85%E5%AD%97%E6%AE%B5">封装字段</a>防止直接访问字段</li>
<li>对方法尽可能采用<a href="#Remove-Setting-Method%EF%BC%9A%E7%A7%BB%E9%99%A4%E8%AE%BE%E5%80%BC%E6%96%B9%E6%B3%95">移除设值方法</a></li>
<li>使用<a href="#Encapsulate-Collection%EF%BC%9A%E5%B0%81%E8%A3%85%E9%9B%86%E5%90%88">封装集合</a>防止直接访问任何集合类型的字段。</li>
<li>査看对象的各个客户。可以对客户使用<a href="#Extract-Method%EF%BC%9A%E6%8A%BD%E5%8F%96%E6%96%B9%E6%B3%95">抽取方法</a>，取出与类相关的代码，然后釆用<a href="#Move-Method%EF%BC%9A%E6%90%AC%E7%A7%BB%E6%96%B9%E6%B3%95">搬移方法</a>将其置于类中。</li>
<li>在完成上述工作后，你可能会发现类中还有多个相似的方法。使用<a href="#Rename-Method%EF%BC%9A%E9%87%8D%E5%91%BD%E5%90%8D%E6%96%B9%E6%B3%95">重命名方法</a>、<a href="#Extract-Method%EF%BC%9A%E6%8A%BD%E5%8F%96%E6%96%B9%E6%B3%95">抽取方法</a>、<a href="#Add-Parameter%EF%BC%9A%E6%B7%BB%E5%8A%A0%E5%8F%82%E6%95%B0">添加参数</a>或<a href="#Remove-Parameter%EF%BC%9A%E7%A7%BB%E9%99%A4%E5%8F%82%E6%95%B0">移除参数</a>等重构技术来协调签名并消除重复。</li>
<li>对字段的大多数访问都不再需要了，因为搬移的方法涵盖了实际使用。此时便可以使用<a href="#Hide-Method%EF%BC%9A%E9%9A%90%E8%97%8F%E6%96%B9%E6%B3%95">隐藏方法</a>来消除对获取方法和设置方法的访问</li>
</ol>
<p><strong>收益</strong><br>可以增强表述能力，可能会暴露重复性问题</p>
<p><strong>例外</strong></p>
<ul>
<li><a href="#Encapsulate-Field%EF%BC%9A%E5%B0%81%E8%A3%85%E5%AD%97%E6%AE%B5">封装字段</a>对性能有影响</li>
</ul>
<h4 id="数据泥团"><a href="#数据泥团" class="headerlink" title="数据泥团"></a>数据泥团</h4><p><strong>症状</strong></p>
<ul>
<li>两到三个同样的项频繁地一同出现在类和参数表中。</li>
<li>在类中同时存在多组字段和方法</li>
<li>各组字段名以类似的子字符串开头或结尾</li>
</ul>
<p><strong>原因</strong><br>这些字段和方法, 往往应该属于另一个类, 但是没有人发现类缺失</p>
<p><strong>措施</strong></p>
<ol>
<li>是类的字段: 抽取字段</li>
<li>在方法签名中: [引入参数对象](Introduce #Parameter-Object：引入参数对象-, 保持参数对象完整</li>
<li>查看调用, 利用<a href="#Move-Method%EF%BC%9A%E6%90%AC%E7%A7%BB%E6%96%B9%E6%B3%95">搬移方法</a>等重构方法</li>
</ol>
<p><strong>收益</strong><br>可以增强表述能力，可能会暴露重复性问题, 通常会降低规模</p>
<p><strong>例外</strong></p>
<ul>
<li>传递对象会带来额外的依赖性</li>
</ul>
<h4 id="临时字段"><a href="#临时字段" class="headerlink" title="临时字段"></a>临时字段</h4><p><strong>症状</strong></p>
<ul>
<li>字段仅在某些时候进行设置，而在其余时间为Null(或不使用）</li>
</ul>
<p><strong>原因</strong><br>通过字段而不是参数来传递信息</p>
<p><strong>措施</strong></p>
<ul>
<li><a href="#Extract-Class%EF%BC%9A%E6%8A%BD%E5%8F%96%E7%B1%BB">抽取类</a>, 移出字段及相关代码</li>
</ul>
<p><strong>收益</strong><br>增强了表述能力并提高了清晰性。可能会减少重复，特别是在其他位置可以使用新类时。</p>
<p><strong>例外</strong></p>
<ul>
<li>有时新对象不是一个有用的对象</li>
</ul>
<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><h4 id="拒收的遗赠"><a href="#拒收的遗赠" class="headerlink" title="拒收的遗赠"></a>拒收的遗赠</h4><p><strong>症状</strong></p>
<ul>
<li>坦率的拒绝: 一个类继承自其父类，但是抛出了一个异常而不是支持一个方法</li>
<li>隐式的拒绝: 某个继承的方法不能正常工作</li>
<li>客户试图通过子类的句柄而不是父类的句柄来访问类。</li>
<li>继承没有什么实际意义，子类并不是父类的一个例子。</li>
</ul>
<p><strong>原因</strong><br>某个类之所以继承自另一个类，可能只是为了实现方便，而不是真的想用这个类来取代其父类。</p>
<p><strong>措施</strong></p>
<ul>
<li>如果不会导致混淆，可以不去管它。</li>
<li>如果找不到共享某个类关系的理由，就<a href="#Replace-Inheritance-with-Delegation%EF%BC%9A%E4%BB%A5%E5%A7%94%E6%89%98%E5%8F%96%E4%BB%A3%E7%BB%A7%E6%89%BF">以委托取代继承</a></li>
<li>如果父子关系确实有意义，则可以通过<a href="#Extract-Subclass%EF%BC%9A%E6%8A%BD%E5%8F%96%E5%AD%90%E7%B1%BB">抽取子类</a>、下移字段和下移方法来创建一个新的子类让这个类拥有非拒绝行为，并将父类的客户修改为这个新类的客户</li>
</ul>
<p><strong>收益</strong><br>可增强表述能力，能改善可测试性</p>
<p><strong>例外</strong></p>
<ul>
<li>有时拒收的遗赠可用于避免新类型的爆炸（通过拒绝特定的方法，就不需要为各种拒绝组合创建一种类型继承体系了）</li>
</ul>
<h4 id="不当的紧密性"><a href="#不当的紧密性" class="headerlink" title="不当的紧密性"></a>不当的紧密性</h4><p><strong>症状</strong></p>
<ul>
<li>一个类访问了它父类的内部（本应是私有的）部分</li>
</ul>
<p><strong>原因</strong><br>子类过分依赖了父类的一些信息, 过度耦合</p>
<p><strong>措施</strong></p>
<ul>
<li>如果子类以一种非受控方式访问父类的字段，则使用自<a href="#Encapsulate-Field%EF%BC%9A%E5%B0%81%E8%A3%85%E5%AD%97%E6%AE%B5">封装字段</a></li>
<li>如果父类可以定义一个子类能插入其中的通用算法，则使用<a href="#Form-Template-Method%EF%BC%9A%E5%A1%91%E9%80%A0%E6%A8%A1%E6%9D%BF%E5%87%BD%E6%95%B0">塑造模板函数</a></li>
<li>如果父类和子类需要进一步解耦合，则采用<a href="#Replace-Inheritance-with-Delegation%EF%BC%9A%E4%BB%A5%E5%A7%94%E6%89%98%E5%8F%96%E4%BB%A3%E7%BB%A7%E6%89%BF">以委托取代继承</a></li>
</ul>
<p><strong>收益</strong><br>可以减少重复。通常能够增强表述能力，还可能会降低规模。</p>
<p><strong>例外</strong><br>无</p>
<h4 id="懒惰类"><a href="#懒惰类" class="headerlink" title="懒惰类"></a>懒惰类</h4><p><strong>症状</strong></p>
<ul>
<li>类没有做什么工作，似乎是它的父类、子类或者调用者完成了所有相关工作</li>
</ul>
<p><strong>原因</strong></p>
<ul>
<li>过度设计</li>
<li>重构过程中，类的所有职责都移到了其他位置</li>
</ul>
<p><strong>措施</strong></p>
<ul>
<li>如果一个类的父类或子类更适合用来完成该类的行为，则通过<a href="#Collapse-Hierarchy%EF%BC%9A%E6%8A%98%E5%8F%A0%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB">折叠继承关系</a>将该类与其父类或子类合并。</li>
<li>否则，通过<a href="#Inline-Class%EF%BC%9A%E5%86%85%E8%81%94%E7%B1%BB">内联类</a>将其行为合并到它的调用者中。</li>
</ul>
<p><strong>收益</strong><br>可降低规模。能增强表述能力，代码更简单</p>
<p><strong>例外</strong></p>
<ul>
<li>有时使用懒惰类是为了传达意图</li>
</ul>
<h3 id="职责"><a href="#职责" class="headerlink" title="职责"></a>职责</h3><h4 id="依恋情节"><a href="#依恋情节" class="headerlink" title="依恋情节"></a>依恋情节</h4><p><strong>症状</strong></p>
<ul>
<li>一个方法似乎过于强调处理其他类的数据,而不是它自己的数据</li>
</ul>
<p><strong>原因</strong><br>常见的现象, 一般是因为代码的迭代, 类的职责发生了便宜</p>
<p><strong>措施</strong></p>
<ul>
<li>使用<a href="#Move-Method%EF%BC%9A%E6%90%AC%E7%A7%BB%E6%96%B9%E6%B3%95">搬移方法</a>将动作放在适当的类中</li>
</ul>
<p><strong>收益</strong><br>可减少重复。通常会增强表述能力,暴露需重构的问题</p>
<p><strong>例外</strong></p>
<ul>
<li>策略模式或者访问者模式</li>
</ul>
<p><strong>说明</strong><br>区分依恋情结和不当的紧密性有时并不简单。<br>依恋情结是指，一个类自身所做甚少，需要借助大量其他类才能完成自己的工作。<br>不当的紧密性则是指，一个类为了访问某些本不该访问的内容，过于深入到其他类中。</p>
<h4 id="不当的紧密性-一般形式"><a href="#不当的紧密性-一般形式" class="headerlink" title="不当的紧密性(一般形式)"></a>不当的紧密性(一般形式)</h4><p><strong>症状</strong></p>
<ul>
<li>一个类访问了另一个类的内部部分(而这一部分本应是私有的)</li>
</ul>
<p><strong>原因</strong><br>两个类之间有时可能会稍有关联。等你意识到存在问题时，这两个类已经过于耦合了</p>
<p><strong>措施</strong></p>
<ul>
<li>如果两个独立的类彼此“纠缠”，则使用<a href="#Move-Method%EF%BC%9A%E6%90%AC%E7%A7%BB%E6%96%B9%E6%B3%95">搬移方法</a>和搬移字段将适当的部分放在适当的类中。</li>
<li>如果纠缠的部分看上去是一个被遗漏的类，则使用<a href="#Extract-Class%EF%BC%9A%E6%8A%BD%E5%8F%96%E7%B1%BB">抽取类</a>和隐藏委托引入这个新类。</li>
<li>如果类相互指向对方，则使用将<a href="#Change-Bidirectional-Association-to-Unidirectional%EF%BC%9A%E5%B0%86%E5%8F%8C%E5%90%91%E5%85%B3%E8%81%94%E6%94%B9%E4%B8%BA%E5%8D%95%E5%90%91">将双向关联改为单向</a></li>
<li>如果子类与父类过于耦合, 参考“不当的紧密性（子类形式）”</li>
</ul>
<p><strong>收益</strong><br>可以减少重复。通常能够增强表述能力，还可能会降低规模。</p>
<p><strong>例外</strong><br>无</p>
<h4 id="消息链"><a href="#消息链" class="headerlink" title="消息链"></a>消息链</h4><p><strong>症状</strong></p>
<ul>
<li>a.b().c().d()形式的调用</li>
</ul>
<p><strong>原因</strong><br>一个对象必须与其他对象协作才能完成工作，这是自然，问题在于这不仅会使对象相互耦合，还会使获得这些对象的路径存在耦合。<br>方法不应与“陌生人”说话，也就是说，它应当只与其自身、其参数、它自己的字段或者它创建的对象有信息传递。</p>
<p><strong>措施</strong></p>
<ul>
<li>如果处理实际针对的是目标对象（即消息链最末端的对象），则使用<a href="#Extract-Method%EF%BC%9A%E6%8A%BD%E5%8F%96%E6%96%B9%E6%B3%95">抽取方法</a>和<a href="#Move-Method%EF%BC%9A%E6%90%AC%E7%A7%BB%E6%96%B9%E6%B3%95">搬移方法</a>将处理置于该对象中。</li>
<li>使用隐藏委托使方法仅依赖于一个对象（因此应将d()方法置于a对象中。这可能还需要为b()和c()对象增加一个d()方法）。</li>
</ul>
<p><strong>收益</strong><br>可以减少重复或者暴露重复性问题</p>
<p><strong>例外</strong><br>如果过分应用隐藏委托，那么对象都去忙着委托，就会没有一个真正做实事的</p>
<h4 id="中间人"><a href="#中间人" class="headerlink" title="中间人"></a>中间人</h4><p><strong>症状</strong></p>
<ul>
<li>类的大多数方法都是在调用另一个对象的同一个（或类似的）方法</li>
<li>如果一个类的任务主要是将工作委托出去，这样的类就称为中间人</li>
</ul>
<p><strong>原因</strong><br>可能是因为应用了隐藏委托来解决消息链引起的。<br>可能在此之后其他一些特性已经被移除了，剩下的主要就是委托方法了。</p>
<p><strong>措施</strong></p>
<ul>
<li>一般来说，可以通过让客户直接调用委托来<a href="#Remove-Middle-Man%EF%BC%9A%E7%A7%BB%E9%99%A4%E4%B8%AD%E9%97%B4%E4%BA%BA">移除中间人</a></li>
<li>如果委托被中间人所有，或者是不可变的，而且中间人还有增加的行为，那么此中间人可以看做委托的一个示例，此时可以<a href="#Replace-Delegation-with-Inheritance%EF%BC%9A%E4%BB%A5%E7%BB%A7%E6%89%BF%E5%8F%96%E4%BB%A3%E5%A7%94%E6%89%98">以继承取代委托</a></li>
</ul>
<p><strong>收益</strong><br>可降低规模，还可能增强表述能力</p>
<p><strong>例外</strong></p>
<ul>
<li>有些模式[如代理模式（Proxy)和装饰器模式（Decorator)]会有意地创建委托</li>
<li>要在中间人和消息链之间权衡。</li>
</ul>
<h3 id="相关改变"><a href="#相关改变" class="headerlink" title="相关改变"></a>相关改变</h3><h4 id="发散式改变"><a href="#发散式改变" class="headerlink" title="发散式改变"></a>发散式改变</h4><p><strong>症状</strong></p>
<ul>
<li>尽管每次原因各异，但发现自己所修改的是同一个类</li>
</ul>
<p><strong>原因</strong><br>类在发展过程中会承担越来越多的职责，但没有人注意到这会涉及两种截然不同的决策</p>
<p><strong>措施</strong></p>
<ul>
<li>如果类既要找到对象，又要对其做一些处理，则让调用者査找对象并将该对象传入，或者让类返回调用者使用的值。</li>
<li>釆用<a href="#Extract-Class%EF%BC%9A%E6%8A%BD%E5%8F%96%E7%B1%BB">抽取类</a>为不同的决策抽取不同的类。</li>
<li>如果几个类共享相同类型的决策，则可以考虑合并这些新类(例如，通过<a href="#Extract-Superclass%EF%BC%9A%E6%8A%BD%E5%8F%96%E8%B6%85%E7%B1%BB">抽取超类</a>或<a href="#Extract-Subclass%EF%BC%9A%E6%8A%BD%E5%8F%96%E5%AD%90%E7%B1%BB">抽取子类</a>)</li>
</ul>
<p><strong>收益</strong><br>可增强表述能力（更好地传达意图），还可以提高健壮性以备将来修改。</p>
<p><strong>例外</strong><br>无</p>
<h4 id="霰弹式修改"><a href="#霰弹式修改" class="headerlink" title="霰弹式修改"></a>霰弹式修改</h4><p><strong>症状</strong></p>
<ul>
<li>仅做一个简单的修改就要更改多个类。</li>
</ul>
<p><strong>原因</strong></p>
<ul>
<li>将多个类分离是代码的一大职责。你可能缺失一个通晓全部职责的类（而大量修改本应通过这个类来完成）。</li>
<li>也有可能是因为你过度去除发散式改变而导致了这个异味。</li>
</ul>
<p><strong>措施</strong></p>
<ul>
<li>找出一个负责这些修改的类。这可能是一个现有类，也可能需要你通过应用<a href="#Extract-Class%EF%BC%9A%E6%8A%BD%E5%8F%96%E7%B1%BB">抽取类</a>来创建一个新类。</li>
<li>使用搬移字段和<a href="#Move-Method%EF%BC%9A%E6%90%AC%E7%A7%BB%E6%96%B9%E6%B3%95">搬移方法</a>将功能置于所选类中。让未选中的类足够简单后，使用<a href="#Inline-Class%EF%BC%9A%E5%86%85%E8%81%94%E7%B1%BB">内联类</a>将该类去除。</li>
</ul>
<p><strong>收益</strong><br>可以减少重复，增强表达能力，并能改进可维护性（将来的修改将更为本地化）。</p>
<p><strong>例外</strong><br>无</p>
<h4 id="并行继承体系"><a href="#并行继承体系" class="headerlink" title="并行继承体系"></a>并行继承体系</h4><p><strong>症状</strong></p>
<ul>
<li>在一个继承体系中建立了一个新子类后，却发现还需要在另一个继承体系中创建一个相关的子类。</li>
<li>可能发现两个继承体系中的子类有着相同的前缀（命名可以反映出协调继承体系的需求）。</li>
<li>这是霰弹式修改的一个特例</li>
</ul>
<p><strong>原因</strong><br>这样两个类并不是无关的, 而是体现了同一决策的不同方面(维度)。</p>
<p><strong>措施</strong></p>
<ul>
<li>使用搬移字段和<a href="#Move-Method%EF%BC%9A%E6%90%AC%E7%A7%BB%E6%96%B9%E6%B3%95">搬移方法</a>来重新分配特性，以便能去除某个继承体系。</li>
</ul>
<p><strong>收益</strong><br>可以减少重复。可能会增强表述能力，也可能会降低规模</p>
<p><strong>例外</strong><br>无</p>
<h4 id="组合爆炸"><a href="#组合爆炸" class="headerlink" title="组合爆炸"></a>组合爆炸</h4><p><strong>症状</strong></p>
<ul>
<li>你本来希望只引入一个单一的新类，但是最后却发现必须在继承体系的不同位置引入多个类。</li>
<li>你发现继承体系的各个层使用了一组常见的词（例如，一层增加了样式信息，下一层增加了可变性）</li>
</ul>
<p><strong>原因</strong><br>这与并行继承体系相关，但是所有内容都折叠到了一个继承体系中 。<br>原本应当是独立的决策却通过一个继承体系实现了。</p>
<p><strong>措施</strong></p>
<ul>
<li>如果问题不严重，可以釆用<a href="#Replace-Inheritance-with-Delegation%EF%BC%9A%E4%BB%A5%E5%A7%94%E6%89%98%E5%8F%96%E4%BB%A3%E7%BB%A7%E6%89%BF">以委托取代继承</a>, 通过为各种变化提供同样的接口，可以创建一个装饰器设计模式示例。</li>
<li>如果情况已经变得相当复杂了，则有必要考虑进行大型重构了，可能还需要梳理并分解继承体系</li>
</ul>
<p><strong>收益</strong><br>可以减少重复, 降低规模</p>
<p><strong>例外</strong><br>无</p>
<h3 id="类库"><a href="#类库" class="headerlink" title="类库"></a>类库</h3><h4 id="不完备的类库"><a href="#不完备的类库" class="headerlink" title="不完备的类库"></a>不完备的类库</h4><p><strong>症状</strong></p>
<ul>
<li>你正在使用一个库类，希望该类具有某种功能，但它没有。</li>
</ul>
<p><strong>原因</strong><br>库类的作者未能满足你的要求</p>
<p><strong>措施</strong></p>
<ul>
<li>弄清类或库的所有者是否会考虑增加你所需要的支持。</li>
<li>如果仅仅是一两个方法，可以对库类的客户应用<a href="#Introduce-Foreign-Method%EF%BC%9A%E5%BC%95%E5%85%A5%E5%A4%96%E5%8A%A0%E5%87%BD%E6%95%B0">引入外加函数</a></li>
<li>如果有多个方法需要增加，则应<a href="#Introduce-Local-Extension%EF%BC%9A%E5%BC%95%E5%85%A5%E6%9C%AC%E5%9C%B0%E6%89%A9%E5%B1%95">引入本地扩展</a></li>
<li>可能需要引入一个层来覆盖这个库</li>
</ul>
<p><strong>收益</strong><br>可以减少重复</p>
<p><strong>例外</strong><br>如果有多个项目，每个项目都使用不兼容的方式来扩展一个类，那么在改变库时就会导致额外的工作</p>
<h2 id="重构技法"><a href="#重构技法" class="headerlink" title="重构技法"></a>重构技法</h2><h3 id="Composing-Methods：优化函数的构成"><a href="#Composing-Methods：优化函数的构成" class="headerlink" title="Composing Methods：优化函数的构成"></a>Composing Methods：优化函数的构成</h3><h4 id="Extract-Method：抽取方法"><a href="#Extract-Method：抽取方法" class="headerlink" title="Extract Method：抽取方法"></a>Extract Method：抽取方法</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">printOwing</span><span class="params">()</span> &#123;</span><br><span class="line">  printBanner();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Print details.</span></span><br><span class="line">  System.out.println(<span class="string">&quot;name: &quot;</span> + name);</span><br><span class="line">  System.out.println(<span class="string">&quot;amount: &quot;</span> + getOutstanding());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">printOwing</span><span class="params">()</span> &#123;</span><br><span class="line">  printBanner();</span><br><span class="line">  printDetails(getOutstanding());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">printDetails</span><span class="params">(<span class="type">double</span> outstanding)</span> &#123;</span><br><span class="line">  System.out.println(<span class="string">&quot;name: &quot;</span> + name);</span><br><span class="line">  System.out.println(<span class="string">&quot;amount: &quot;</span> + outstanding);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Inline-Method：内联方法"><a href="#Inline-Method：内联方法" class="headerlink" title="Inline Method：内联方法"></a>Inline Method：内联方法</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PizzaDelivery</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="type">int</span> <span class="title function_">getRating</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> moreThanFiveLateDeliveries() ? <span class="number">2</span> : <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">boolean</span> <span class="title function_">moreThanFiveLateDeliveries</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> numberOfLateDeliveries &gt; <span class="number">5</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PizzaDelivery</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="type">int</span> <span class="title function_">getRating</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> numberOfLateDeliveries &gt; <span class="number">5</span> ? <span class="number">2</span> : <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Extract-Variable：提炼变量"><a href="#Extract-Variable：提炼变量" class="headerlink" title="Extract Variable：提炼变量"></a>Extract Variable：提炼变量</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">renderBanner</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> ((platform.toUpperCase().indexOf(<span class="string">&quot;MAC&quot;</span>) &gt; -<span class="number">1</span>) &amp;&amp;</span><br><span class="line">       (browser.toUpperCase().indexOf(<span class="string">&quot;IE&quot;</span>) &gt; -<span class="number">1</span>) &amp;&amp;</span><br><span class="line">        wasInitialized() &amp;&amp; resize &gt; <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">renderBanner</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="type">boolean</span> <span class="variable">isMacOs</span> <span class="operator">=</span> platform.toUpperCase().indexOf(<span class="string">&quot;MAC&quot;</span>) &gt; -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">final</span> <span class="type">boolean</span> <span class="variable">isIE</span> <span class="operator">=</span> browser.toUpperCase().indexOf(<span class="string">&quot;IE&quot;</span>) &gt; -<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">final</span> <span class="type">boolean</span> <span class="variable">wasResized</span> <span class="operator">=</span> resize &gt; <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isMacOs &amp;&amp; isIE &amp;&amp; wasInitialized() &amp;&amp; wasResized) &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Inline-Temp：内联临时变量"><a href="#Inline-Temp：内联临时变量" class="headerlink" title="Inline Temp：内联临时变量"></a>Inline Temp：内联临时变量</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">hasDiscount</span><span class="params">(Order order)</span> &#123;</span><br><span class="line">  <span class="type">double</span> <span class="variable">basePrice</span> <span class="operator">=</span> order.basePrice();</span><br><span class="line">  <span class="keyword">return</span> basePrice &gt; <span class="number">1000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">hasDiscount</span><span class="params">(Order order)</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> order.basePrice() &gt; <span class="number">1000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Replace-Temp-with-Query：以查询取代临时变量"><a href="#Replace-Temp-with-Query：以查询取代临时变量" class="headerlink" title="Replace Temp with Query：以查询取代临时变量"></a>Replace Temp with Query：以查询取代临时变量</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">calculateTotal</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="type">double</span> <span class="variable">basePrice</span> <span class="operator">=</span> quantity * itemPrice;</span><br><span class="line">  <span class="keyword">if</span> (basePrice &gt; <span class="number">1000</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> basePrice * <span class="number">0.95</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> basePrice * <span class="number">0.98</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">calculateTotal</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (basePrice() &gt; <span class="number">1000</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> basePrice() * <span class="number">0.95</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> basePrice() * <span class="number">0.98</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">double</span> <span class="title function_">basePrice</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> quantity * itemPrice;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Split-Temporary-Variable：拆分临时变量"><a href="#Split-Temporary-Variable：拆分临时变量" class="headerlink" title="Split Temporary Variable：拆分临时变量"></a>Split Temporary Variable：拆分临时变量</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="variable">temp</span> <span class="operator">=</span> <span class="number">2</span> * (height + width);</span><br><span class="line">System.out.println(temp);</span><br><span class="line">temp = height * width;</span><br><span class="line">System.out.println(temp);</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">double</span> <span class="variable">perimeter</span> <span class="operator">=</span> <span class="number">2</span> * (height + width);</span><br><span class="line">System.out.println(perimeter);</span><br><span class="line"><span class="keyword">final</span> <span class="type">double</span> <span class="variable">area</span> <span class="operator">=</span> height * width;</span><br><span class="line">System.out.println(area);</span><br></pre></td></tr></table></figure>


<h4 id="Remove-Assignments-to-Parameters：移除参数赋值"><a href="#Remove-Assignments-to-Parameters：移除参数赋值" class="headerlink" title="Remove Assignments to Parameters：移除参数赋值"></a>Remove Assignments to Parameters：移除参数赋值</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">discount</span><span class="params">(<span class="type">int</span> inputVal, <span class="type">int</span> quantity)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (inputVal &gt; <span class="number">50</span>) &#123;</span><br><span class="line">    inputVal -= <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">discount</span><span class="params">(<span class="type">int</span> inputVal, <span class="type">int</span> quantity)</span> &#123;</span><br><span class="line">  <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> inputVal;</span><br><span class="line">  <span class="keyword">if</span> (inputVal &gt; <span class="number">50</span>) &#123;</span><br><span class="line">    result -= <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Replace-Method-with-Method-Object：以方法对象替代方法"><a href="#Replace-Method-with-Method-Object：以方法对象替代方法" class="headerlink" title="Replace Method with Method Object：以方法对象替代方法"></a>Replace Method with Method Object：以方法对象替代方法</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Order</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">price</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">double</span> primaryBasePrice;</span><br><span class="line">    <span class="type">double</span> secondaryBasePrice;</span><br><span class="line">    <span class="type">double</span> tertiaryBasePrice;</span><br><span class="line">    <span class="comment">// Perform long computation.</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Order</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">price</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PriceCalculator</span>(<span class="built_in">this</span>).compute();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PriceCalculator</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">double</span> primaryBasePrice;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">double</span> secondaryBasePrice;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">double</span> tertiaryBasePrice;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">PriceCalculator</span><span class="params">(Order order)</span> &#123;</span><br><span class="line">    <span class="comment">// Copy relevant information from the</span></span><br><span class="line">    <span class="comment">// order object.</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">compute</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// Perform long computation.</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Substitute-Algorithm：替换算法"><a href="#Substitute-Algorithm：替换算法" class="headerlink" title="Substitute Algorithm：替换算法"></a>Substitute Algorithm：替换算法</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">String <span class="title function_">foundPerson</span><span class="params">(String[] people)</span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; people.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (people[i].equals(<span class="string">&quot;Don&quot;</span>))&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;Don&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (people[i].equals(<span class="string">&quot;John&quot;</span>))&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;John&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (people[i].equals(<span class="string">&quot;Kent&quot;</span>))&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&quot;Kent&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">String <span class="title function_">foundPerson</span><span class="params">(String[] people)</span>&#123;</span><br><span class="line">  <span class="type">List</span> <span class="variable">candidates</span> <span class="operator">=</span></span><br><span class="line">    Arrays.asList(<span class="keyword">new</span> <span class="title class_">String</span>[] &#123;<span class="string">&quot;Don&quot;</span>, <span class="string">&quot;John&quot;</span>, <span class="string">&quot;Kent&quot;</span>&#125;);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i &lt; people.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (candidates.contains(people[i])) &#123;</span><br><span class="line">      <span class="keyword">return</span> people[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Moving-Features-between-Objects：在对象之间搬移特性"><a href="#Moving-Features-between-Objects：在对象之间搬移特性" class="headerlink" title="Moving Features between Objects：在对象之间搬移特性"></a>Moving Features between Objects：在对象之间搬移特性</h3><h4 id="Move-Method：搬移方法"><a href="#Move-Method：搬移方法" class="headerlink" title="Move Method：搬移方法"></a>Move Method：搬移方法</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-move-method-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-move-method-after.png" alt="after"></p>
<h4 id="Move-Field：搬移字段"><a href="#Move-Field：搬移字段" class="headerlink" title="Move Field：搬移字段"></a>Move Field：搬移字段</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-move-field-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-move-field-after.png" alt="after"></p>
<h4 id="Extract-Class：抽取类"><a href="#Extract-Class：抽取类" class="headerlink" title="Extract Class：抽取类"></a>Extract Class：抽取类</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-extract-class-before.png" alt="before"><img src="https://image.ponder.work/mweb/2020-10-18-extract-class-after.png" alt="after"></p>
<h4 id="Inline-Class：内联类"><a href="#Inline-Class：内联类" class="headerlink" title="Inline Class：内联类"></a>Inline Class：内联类</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-inline-class-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-inline-class-after.png" alt="after"></p>
<h4 id="Hide-Delegate：隐藏委托"><a href="#Hide-Delegate：隐藏委托" class="headerlink" title="Hide Delegate：隐藏委托"></a>Hide Delegate：隐藏委托</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-hide-delegate-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-hide-delegate-after.png" alt="after"></p>
<h4 id="Remove-Middle-Man：移除中间人"><a href="#Remove-Middle-Man：移除中间人" class="headerlink" title="Remove Middle Man：移除中间人"></a>Remove Middle Man：移除中间人</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-remove-middle-man-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-remove-middle-man-after.png" alt="after"></p>
<h4 id="Introduce-Foreign-Method：引入外加函数"><a href="#Introduce-Foreign-Method：引入外加函数" class="headerlink" title="Introduce Foreign Method：引入外加函数"></a>Introduce Foreign Method：引入外加函数</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Report</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">sendReport</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Date</span> <span class="variable">nextDay</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>(previousEnd.getYear(),</span><br><span class="line">      previousEnd.getMonth(), previousEnd.getDate() + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Report</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">void</span> <span class="title function_">sendReport</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Date</span> <span class="variable">newStart</span> <span class="operator">=</span> nextDay(previousEnd);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> Date <span class="title function_">nextDay</span><span class="params">(Date arg)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Date</span>(arg.getYear(), arg.getMonth(), arg.getDate() + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Introduce-Local-Extension：引入本地扩展"><a href="#Introduce-Local-Extension：引入本地扩展" class="headerlink" title="Introduce Local Extension：引入本地扩展"></a>Introduce Local Extension：引入本地扩展</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-introduce-local-extension-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-introduce-local-extension-after.png" alt="after"></p>
<h3 id="Organizing-Data：重新组织数据"><a href="#Organizing-Data：重新组织数据" class="headerlink" title="Organizing Data：重新组织数据"></a>Organizing Data：重新组织数据</h3><h4 id="Change-Value-to-Reference：将值对象改为引用对象"><a href="#Change-Value-to-Reference：将值对象改为引用对象" class="headerlink" title="Change Value to Reference：将值对象改为引用对象"></a>Change Value to Reference：将值对象改为引用对象</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-change-value-to-reference-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-change-value-to-reference-after.png" alt="after"></p>
<h4 id="Change-Reference-to-Value：将引用对象改为值对象"><a href="#Change-Reference-to-Value：将引用对象改为值对象" class="headerlink" title="Change Reference to Value：将引用对象改为值对象"></a>Change Reference to Value：将引用对象改为值对象</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-change-reference-to-value-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-change-reference-to-value-after.png" alt="after"></p>
<h4 id="Duplicate-Observed-Data：复制被监视数据"><a href="#Duplicate-Observed-Data：复制被监视数据" class="headerlink" title="Duplicate Observed Data：复制被监视数据"></a>Duplicate Observed Data：复制被监视数据</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-duplicate-observed-data-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-duplicate-observed-data-after.png" alt="after"></p>
<h4 id="Self-Encapsulate-Field：自封装字段"><a href="#Self-Encapsulate-Field：自封装字段" class="headerlink" title="Self Encapsulate Field：自封装字段"></a>Self Encapsulate Field：自封装字段</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Range</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> low, high;</span><br><span class="line">  <span class="type">boolean</span> <span class="title function_">includes</span><span class="params">(<span class="type">int</span> arg)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> arg &gt;= low &amp;&amp; arg &lt;= high;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Range</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="type">int</span> low, high;</span><br><span class="line">  <span class="type">boolean</span> <span class="title function_">includes</span><span class="params">(<span class="type">int</span> arg)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> arg &gt;= getLow() &amp;&amp; arg &lt;= getHigh();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> <span class="title function_">getLow</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> low;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="type">int</span> <span class="title function_">getHigh</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> high;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Replace-Data-Value-with-Object：以对象取代数据值"><a href="#Replace-Data-Value-with-Object：以对象取代数据值" class="headerlink" title="Replace Data Value with Object：以对象取代数据值"></a>Replace Data Value with Object：以对象取代数据值</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-replace-data-value-with-object-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-replace-data-value-with-object-after.png" alt="after"></p>
<h4 id="Replace-Array-with-Object：以对象取代数组"><a href="#Replace-Array-with-Object：以对象取代数组" class="headerlink" title="Replace Array with Object：以对象取代数组"></a>Replace Array with Object：以对象取代数组</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String[] row = <span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">2</span>];</span><br><span class="line">row[<span class="number">0</span>] = <span class="string">&quot;Liverpool&quot;</span>;</span><br><span class="line">row[<span class="number">1</span>] = <span class="string">&quot;15&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Performance</span> <span class="variable">row</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Performance</span>();</span><br><span class="line">row.setName(<span class="string">&quot;Liverpool&quot;</span>);</span><br><span class="line">row.setWins(<span class="string">&quot;15&quot;</span>);</span><br></pre></td></tr></table></figure>


<h4 id="Change-Unidirectional-Association-to-Bidirectional：将单向关联改为双向"><a href="#Change-Unidirectional-Association-to-Bidirectional：将单向关联改为双向" class="headerlink" title="Change Unidirectional Association to Bidirectional：将单向关联改为双向"></a>Change Unidirectional Association to Bidirectional：将单向关联改为双向</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-change-unidirectional-association-to-bidirectional-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-change-unidirectional-association-to-bidirectional-after.png" alt="after"></p>
<h4 id="Change-Bidirectional-Association-to-Unidirectional：将双向关联改为单向"><a href="#Change-Bidirectional-Association-to-Unidirectional：将双向关联改为单向" class="headerlink" title="Change Bidirectional Association to Unidirectional：将双向关联改为单向"></a>Change Bidirectional Association to Unidirectional：将双向关联改为单向</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-change-bidirectional-association-to-unidirectional-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-change-bidirectional-association-to-unidirectional-after.png" alt="after"></p>
<h4 id="Encapsulate-Field：封装字段"><a href="#Encapsulate-Field：封装字段" class="headerlink" title="Encapsulate Field：封装字段"></a>Encapsulate Field：封装字段</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> String name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String arg)</span> &#123;</span><br><span class="line">    name = arg;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Encapsulate-Collection：封装集合"><a href="#Encapsulate-Collection：封装集合" class="headerlink" title="Encapsulate Collection：封装集合"></a>Encapsulate Collection：封装集合</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-encapsulate-collection-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-encapsulate-collection-after.png" alt="after"></p>
<h4 id="Replace-Magic-Number-with-Symbolic-Constant：以符号常量取代魔法数"><a href="#Replace-Magic-Number-with-Symbolic-Constant：以符号常量取代魔法数" class="headerlink" title="Replace Magic Number with Symbolic Constant：以符号常量取代魔法数"></a>Replace Magic Number with Symbolic Constant：以符号常量取代魔法数</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">potentialEnergy</span><span class="params">(<span class="type">double</span> mass, <span class="type">double</span> height)</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> mass * height * <span class="number">9.81</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="type">double</span> <span class="variable">GRAVITATIONAL_CONSTANT</span> <span class="operator">=</span> <span class="number">9.81</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">double</span> <span class="title function_">potentialEnergy</span><span class="params">(<span class="type">double</span> mass, <span class="type">double</span> height)</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> mass * height * GRAVITATIONAL_CONSTANT;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Replace-Type-Code-with-Class：以类取代类型码"><a href="#Replace-Type-Code-with-Class：以类取代类型码" class="headerlink" title="Replace Type Code with Class：以类取代类型码"></a>Replace Type Code with Class：以类取代类型码</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-replace-type-code-with-class-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-replace-type-code-with-class-after.png" alt="after"></p>
<h4 id="Replace-Type-Code-with-Subclasses：以子类取代类型码"><a href="#Replace-Type-Code-with-Subclasses：以子类取代类型码" class="headerlink" title="Replace Type Code with Subclasses：以子类取代类型码"></a>Replace Type Code with Subclasses：以子类取代类型码</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-replace-type-code-with-subclasses-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-replace-type-code-with-subclasses-after.png" alt="after"></p>
<h4 id="Replace-Type-Code-with-State-Strategy：以状态-策略取代类型码"><a href="#Replace-Type-Code-with-State-Strategy：以状态-策略取代类型码" class="headerlink" title="Replace Type Code with State&#x2F;Strategy：以状态&#x2F;策略取代类型码"></a>Replace Type Code with State&#x2F;Strategy：以状态&#x2F;策略取代类型码</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-replace-type-code-with-state-strategy-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-replace-type-code-with-state-strategy-after.png" alt="after"></p>
<h4 id="Replace-Subclass-with-Fields：以字段取代子类"><a href="#Replace-Subclass-with-Fields：以字段取代子类" class="headerlink" title="Replace Subclass with Fields：以字段取代子类"></a>Replace Subclass with Fields：以字段取代子类</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-replace-subclass-with-fields-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-replace-subclass-with-fields-after.png" alt="after"></p>
<h3 id="Simplifying-Conditional-Expressions：简化条件表达式"><a href="#Simplifying-Conditional-Expressions：简化条件表达式" class="headerlink" title="Simplifying Conditional Expressions：简化条件表达式"></a>Simplifying Conditional Expressions：简化条件表达式</h3><h4 id="Consolidate-Conditional-Expression：合并条件表达式"><a href="#Consolidate-Conditional-Expression：合并条件表达式" class="headerlink" title="Consolidate Conditional Expression：合并条件表达式"></a>Consolidate Conditional Expression：合并条件表达式</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">disabilityAmount</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (seniority &lt; <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (monthsDisabled &gt; <span class="number">12</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (isPartTime) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Compute the disability amount.</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">disabilityAmount</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (isNotEligibleForDisability()) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Compute the disability amount.</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Consolidate-Duplicate-Conditional-Fragments：合并重复条件片断"><a href="#Consolidate-Duplicate-Conditional-Fragments：合并重复条件片断" class="headerlink" title="Consolidate Duplicate Conditional Fragments：合并重复条件片断"></a>Consolidate Duplicate Conditional Fragments：合并重复条件片断</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isSpecialDeal()) &#123;</span><br><span class="line">  total = price * <span class="number">0.95</span>;</span><br><span class="line">  send();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  total = price * <span class="number">0.98</span>;</span><br><span class="line">  send();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isSpecialDeal()) &#123;</span><br><span class="line">  total = price * <span class="number">0.95</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  total = price * <span class="number">0.98</span>;</span><br><span class="line">&#125;</span><br><span class="line">send();</span><br></pre></td></tr></table></figure>


<h4 id="Decompose-Conditional：分解条件表达式"><a href="#Decompose-Conditional：分解条件表达式" class="headerlink" title="Decompose Conditional：分解条件表达式"></a>Decompose Conditional：分解条件表达式</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (date.before(SUMMER_START) || date.after(SUMMER_END)) &#123;</span><br><span class="line">  charge = quantity * winterRate + winterServiceCharge;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  charge = quantity * summerRate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (isSummer(date)) &#123;</span><br><span class="line">  charge = summerCharge(quantity);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  charge = winterCharge(quantity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Replace-Conditional-with-Polymorphism：以多态取代条件表达式"><a href="#Replace-Conditional-with-Polymorphism：以多态取代条件表达式" class="headerlink" title="Replace Conditional with Polymorphism：以多态取代条件表达式"></a>Replace Conditional with Polymorphism：以多态取代条件表达式</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="type">double</span> <span class="title function_">getSpeed</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">      <span class="keyword">case</span> EUROPEAN:</span><br><span class="line">        <span class="keyword">return</span> getBaseSpeed();</span><br><span class="line">      <span class="keyword">case</span> AFRICAN:</span><br><span class="line">        <span class="keyword">return</span> getBaseSpeed() - getLoadFactor() * numberOfCoconuts;</span><br><span class="line">      <span class="keyword">case</span> NORWEGIAN_BLUE:</span><br><span class="line">        <span class="keyword">return</span> (isNailed) ? <span class="number">0</span> : getBaseSpeed(voltage);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Should be unreachable&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="keyword">abstract</span> <span class="type">double</span> <span class="title function_">getSpeed</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">European</span> <span class="keyword">extends</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">  <span class="type">double</span> <span class="title function_">getSpeed</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> getBaseSpeed();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">African</span> <span class="keyword">extends</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">  <span class="type">double</span> <span class="title function_">getSpeed</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> getBaseSpeed() - getLoadFactor() * numberOfCoconuts;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NorwegianBlue</span> <span class="keyword">extends</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">  <span class="type">double</span> <span class="title function_">getSpeed</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (isNailed) ? <span class="number">0</span> : getBaseSpeed(voltage);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Somewhere in client code</span></span><br><span class="line">speed = bird.getSpeed();</span><br></pre></td></tr></table></figure>


<h4 id="Remove-Control-Flag：移除控制标记"><a href="#Remove-Control-Flag：移除控制标记" class="headerlink" title="Remove Control Flag：移除控制标记"></a>Remove Control Flag：移除控制标记</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">String <span class="title function_">foundMiscreant</span><span class="params">(String[] people)</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">found</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; people.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (found.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (people[i].equals (<span class="string">&quot;John&quot;</span>))&#123;</span><br><span class="line">                sendAlert();</span><br><span class="line">                found = <span class="string">&quot;John&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> found;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">String <span class="title function_">foundMiscreant</span><span class="params">(String[] people)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; people.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (found.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (people[i].equals (<span class="string">&quot;John&quot;</span>))&#123;</span><br><span class="line">                sendAlert();</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;John&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Replace-Nested-Conditional-with-Guard-Clauses：以卫语句取代嵌套条件式"><a href="#Replace-Nested-Conditional-with-Guard-Clauses：以卫语句取代嵌套条件式" class="headerlink" title="Replace Nested Conditional with Guard Clauses：以卫语句取代嵌套条件式"></a>Replace Nested Conditional with Guard Clauses：以卫语句取代嵌套条件式</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getPayAmount</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="type">double</span> result;</span><br><span class="line">  <span class="keyword">if</span> (isDead)&#123;</span><br><span class="line">    result = deadAmount();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (isSeparated)&#123;</span><br><span class="line">      result = separatedAmount();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (isRetired)&#123;</span><br><span class="line">        result = retiredAmount();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        result = normalPayAmount();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getPayAmount</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (isDead)&#123;</span><br><span class="line">    <span class="keyword">return</span> deadAmount();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (isSeparated)&#123;</span><br><span class="line">    <span class="keyword">return</span> separatedAmount();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (isRetired)&#123;</span><br><span class="line">    <span class="keyword">return</span> retiredAmount();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> normalPayAmount();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Introduce-Null-Object：引入Null对象"><a href="#Introduce-Null-Object：引入Null对象" class="headerlink" title="Introduce Null Object：引入Null对象"></a>Introduce Null Object：引入Null对象</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (customer == <span class="literal">null</span>) &#123;</span><br><span class="line">  plan = BillingPlan.basic();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  plan = customer.getPlan();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NullCustomer</span> <span class="keyword">extends</span> <span class="title class_">Customer</span> &#123;</span><br><span class="line">  <span class="type">boolean</span> <span class="title function_">isNull</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  Plan <span class="title function_">getPlan</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">NullPlan</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Some other NULL functionality.</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Replace null values with Null-object.</span></span><br><span class="line">customer = (order.customer != <span class="literal">null</span>) ?</span><br><span class="line">  order.customer : <span class="keyword">new</span> <span class="title class_">NullCustomer</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Use Null-object as if it&#x27;s normal subclass.</span></span><br><span class="line">plan = customer.getPlan();</span><br></pre></td></tr></table></figure>


<h4 id="Introduce-Assertion：引入断言"><a href="#Introduce-Assertion：引入断言" class="headerlink" title="Introduce Assertion：引入断言"></a>Introduce Assertion：引入断言</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">getExpenseLimit</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="comment">// Should have either expense limit or</span></span><br><span class="line">  <span class="comment">// a primary project.</span></span><br><span class="line">  <span class="keyword">return</span> (expenseLimit != NULL_EXPENSE) ?</span><br><span class="line">    expenseLimit :</span><br><span class="line">    primaryProject.getMemberExpenseLimit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">getExpenseLimit</span><span class="params">()</span> &#123;</span><br><span class="line">  Assert.isTrue(expenseLimit != NULL_EXPENSE || primaryProject != <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (expenseLimit != NULL_EXPENSE) ?</span><br><span class="line">    expenseLimit:</span><br><span class="line">    primaryProject.getMemberExpenseLimit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="Simplifying-Method-Calls：简化方法调用"><a href="#Simplifying-Method-Calls：简化方法调用" class="headerlink" title="Simplifying Method Calls：简化方法调用"></a>Simplifying Method Calls：简化方法调用</h3><h4 id="Add-Parameter：添加参数"><a href="#Add-Parameter：添加参数" class="headerlink" title="Add Parameter：添加参数"></a>Add Parameter：添加参数</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-add-parameter-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-add-parameter-after.png" alt="after"></p>
<h4 id="Remove-Parameter：移除参数"><a href="#Remove-Parameter：移除参数" class="headerlink" title="Remove Parameter：移除参数"></a>Remove Parameter：移除参数</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-remove-parameter-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-remove-parameter-after.png" alt="after"></p>
<h4 id="Rename-Method：重命名方法"><a href="#Rename-Method：重命名方法" class="headerlink" title="Rename Method：重命名方法"></a>Rename Method：重命名方法</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-rename-method-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-rename-method-after.png" alt="after"></p>
<h4 id="Separate-Query-from-Modifier：将查询方法和修改方法分离"><a href="#Separate-Query-from-Modifier：将查询方法和修改方法分离" class="headerlink" title="Separate Query from Modifier：将查询方法和修改方法分离"></a>Separate Query from Modifier：将查询方法和修改方法分离</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-separate-query-from-modifier-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-separate-query-from-modifier-after.png" alt="after"></p>
<h4 id="Parameterize-Method：让方法携带参数"><a href="#Parameterize-Method：让方法携带参数" class="headerlink" title="Parameterize Method：让方法携带参数"></a>Parameterize Method：让方法携带参数</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-parameterize-method-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-parameterize-method-after.png" alt="after"></p>
<h4 id="Introduce-Parameter-Object：引入参数对象"><a href="#Introduce-Parameter-Object：引入参数对象" class="headerlink" title="Introduce Parameter Object：引入参数对象"></a>Introduce Parameter Object：引入参数对象</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-introduce-parameter-object-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-introduce-parameter-object-after.png" alt="after"></p>
<h4 id="Preserve-Whole-Object：保持对象完整"><a href="#Preserve-Whole-Object：保持对象完整" class="headerlink" title="Preserve Whole Object：保持对象完整"></a>Preserve Whole Object：保持对象完整</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">low</span> <span class="operator">=</span> daysTempRange.getLow();</span><br><span class="line"><span class="type">int</span> <span class="variable">high</span> <span class="operator">=</span> daysTempRange.getHigh();</span><br><span class="line"><span class="type">boolean</span> <span class="variable">withinPlan</span> <span class="operator">=</span> plan.withinRange(low, high);</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="variable">withinPlan</span> <span class="operator">=</span> plan.withinRange(daysTempRange);</span><br></pre></td></tr></table></figure>


<h4 id="Remove-Setting-Method：移除设值方法"><a href="#Remove-Setting-Method：移除设值方法" class="headerlink" title="Remove Setting Method：移除设值方法"></a>Remove Setting Method：移除设值方法</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-remove-setting-method-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-remove-setting-method-after.png" alt="after"></p>
<h4 id="Replace-Parameter-with-Explicit-Methods：以明确函数取代参数"><a href="#Replace-Parameter-with-Explicit-Methods：以明确函数取代参数" class="headerlink" title="Replace Parameter with Explicit Methods：以明确函数取代参数"></a>Replace Parameter with Explicit Methods：以明确函数取代参数</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(String name, <span class="type">int</span> value)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (name.equals(<span class="string">&quot;height&quot;</span>)) &#123;</span><br><span class="line">    height = value;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (name.equals(<span class="string">&quot;width&quot;</span>)) &#123;</span><br><span class="line">    width = value;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  Assert.shouldNeverReachHere();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">setHeight</span><span class="params">(<span class="type">int</span> arg)</span> &#123;</span><br><span class="line">  height = arg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">setWidth</span><span class="params">(<span class="type">int</span> arg)</span> &#123;</span><br><span class="line">  width = arg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Replace-Parameter-with-Method-Call：以函数调用取代参数"><a href="#Replace-Parameter-with-Method-Call：以函数调用取代参数" class="headerlink" title="Replace Parameter with Method Call：以函数调用取代参数"></a>Replace Parameter with Method Call：以函数调用取代参数</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">basePrice</span> <span class="operator">=</span> quantity * itemPrice;</span><br><span class="line"><span class="type">double</span> <span class="variable">seasonDiscount</span> <span class="operator">=</span> <span class="built_in">this</span>.getSeasonalDiscount();</span><br><span class="line"><span class="type">double</span> <span class="variable">fees</span> <span class="operator">=</span> <span class="built_in">this</span>.getFees();</span><br><span class="line"><span class="type">double</span> <span class="variable">finalPrice</span> <span class="operator">=</span> discountedPrice(basePrice, seasonDiscount, fees);</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">basePrice</span> <span class="operator">=</span> quantity * itemPrice;</span><br><span class="line"><span class="type">double</span> <span class="variable">finalPrice</span> <span class="operator">=</span> discountedPrice(basePrice);</span><br></pre></td></tr></table></figure>


<h4 id="Hide-Method：隐藏方法"><a href="#Hide-Method：隐藏方法" class="headerlink" title="Hide Method：隐藏方法"></a>Hide Method：隐藏方法</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-hide-method-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-hide-method-after.png" alt="after"></p>
<h4 id="Replace-Constructor-with-Factory-Method：以工厂方法取代构造函数"><a href="#Replace-Constructor-with-Factory-Method：以工厂方法取代构造函数" class="headerlink" title="Replace Constructor with Factory Method：以工厂方法取代构造函数"></a>Replace Constructor with Factory Method：以工厂方法取代构造函数</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">  Employee(<span class="type">int</span> type) &#123;</span><br><span class="line">    <span class="built_in">this</span>.type = type;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> Employee <span class="title function_">create</span><span class="params">(<span class="type">int</span> type)</span> &#123;</span><br><span class="line">    employee = <span class="keyword">new</span> <span class="title class_">Employee</span>(type);</span><br><span class="line">    <span class="comment">// do some heavy lifting.</span></span><br><span class="line">    <span class="keyword">return</span> employee;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Replace-Error-Code-with-Exception：以异常取代错误码"><a href="#Replace-Error-Code-with-Exception：以异常取代错误码" class="headerlink" title="Replace Error Code with Exception：以异常取代错误码"></a>Replace Error Code with Exception：以异常取代错误码</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">withdraw</span><span class="params">(<span class="type">int</span> amount)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (amount &gt; _balance) &#123;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    balance -= amount;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">withdraw</span><span class="params">(<span class="type">int</span> amount)</span> <span class="keyword">throws</span> BalanceException &#123;</span><br><span class="line">  <span class="keyword">if</span> (amount &gt; _balance) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BalanceException</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  balance -= amount;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Replace-Exception-with-Test：以测试取代异常"><a href="#Replace-Exception-with-Test：以测试取代异常" class="headerlink" title="Replace Exception with Test：以测试取代异常"></a>Replace Exception with Test：以测试取代异常</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">getValueForPeriod</span><span class="params">(<span class="type">int</span> periodNumber)</span> &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> values[periodNumber];</span><br><span class="line">  &#125; <span class="keyword">catch</span> (ArrayIndexOutOfBoundsException e) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="title function_">getValueForPeriod</span><span class="params">(<span class="type">int</span> periodNumber)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (periodNumber &gt;= values.length) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> values[periodNumber];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Pull-Up-Field：上移字段"><a href="#Pull-Up-Field：上移字段" class="headerlink" title="Pull Up Field：上移字段"></a>Pull Up Field：上移字段</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-pull-up-field-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-pull-up-field-after.png" alt="after"></p>
<h4 id="Pull-Up-Method：上移方法"><a href="#Pull-Up-Method：上移方法" class="headerlink" title="Pull Up Method：上移方法"></a>Pull Up Method：上移方法</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-pull-up-method-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-pull-up-method-after.png" alt="after"></p>
<h4 id="Pull-Up-Constructor-Body：上移构造函数本体"><a href="#Pull-Up-Constructor-Body：上移构造函数本体" class="headerlink" title="Pull Up Constructor Body：上移构造函数本体"></a>Pull Up Constructor Body：上移构造函数本体</h4><p>before</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Manager</span> <span class="keyword">extends</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Manager</span><span class="params">(String name, String id, <span class="type">int</span> grade)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.id = id;</span><br><span class="line">    <span class="built_in">this</span>.grade = grade;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>after</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Manager</span> <span class="keyword">extends</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">Manager</span><span class="params">(String name, String id, <span class="type">int</span> grade)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(name, id);</span><br><span class="line">    <span class="built_in">this</span>.grade = grade;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Dealing-with-Generalization：处理概括关系"><a href="#Dealing-with-Generalization：处理概括关系" class="headerlink" title="Dealing with Generalization：处理概括关系"></a>Dealing with Generalization：处理概括关系</h3><h4 id="Push-Down-Field：下移字段"><a href="#Push-Down-Field：下移字段" class="headerlink" title="Push Down Field：下移字段"></a>Push Down Field：下移字段</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-push-down-field-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-push-down-field-after.png" alt="after"></p>
<h4 id="Push-Down-Method：下移方法"><a href="#Push-Down-Method：下移方法" class="headerlink" title="Push Down Method：下移方法"></a>Push Down Method：下移方法</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-push-down-method-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-push-down-method-after.png" alt="after"></p>
<h4 id="Extract-Subclass：抽取子类"><a href="#Extract-Subclass：抽取子类" class="headerlink" title="Extract Subclass：抽取子类"></a>Extract Subclass：抽取子类</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-extract-subclass-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-extract-subclass-after.png" alt="after"></p>
<h4 id="Extract-Superclass：抽取超类"><a href="#Extract-Superclass：抽取超类" class="headerlink" title="Extract Superclass：抽取超类"></a>Extract Superclass：抽取超类</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-extract-superclass-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-extract-superclass-after.png" alt="after"></p>
<h4 id="Extract-Interface：抽取接口"><a href="#Extract-Interface：抽取接口" class="headerlink" title="Extract Interface：抽取接口"></a>Extract Interface：抽取接口</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-extract-interface-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-extract-interface-after.png" alt="after"></p>
<h4 id="Collapse-Hierarchy：折叠继承关系"><a href="#Collapse-Hierarchy：折叠继承关系" class="headerlink" title="Collapse Hierarchy：折叠继承关系"></a>Collapse Hierarchy：折叠继承关系</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-collapse-hierarchy-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-collapse-hierarchy-after.png" alt="after"></p>
<h4 id="Form-Template-Method：塑造模板函数"><a href="#Form-Template-Method：塑造模板函数" class="headerlink" title="Form Template Method：塑造模板函数"></a>Form Template Method：塑造模板函数</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-form-template-method-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-form-template-method-after.png" alt="after"></p>
<h4 id="Replace-Inheritance-with-Delegation：以委托取代继承"><a href="#Replace-Inheritance-with-Delegation：以委托取代继承" class="headerlink" title="Replace Inheritance with Delegation：以委托取代继承"></a>Replace Inheritance with Delegation：以委托取代继承</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-replace-inheritance-with-delegation-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-replace-inheritance-with-delegation-after.png" alt="after"></p>
<h4 id="Replace-Delegation-with-Inheritance：以继承取代委托"><a href="#Replace-Delegation-with-Inheritance：以继承取代委托" class="headerlink" title="Replace Delegation with Inheritance：以继承取代委托"></a>Replace Delegation with Inheritance：以继承取代委托</h4><p><img src="https://image.ponder.work/mweb/2020-10-18-replace-delegation-with-inheritance-before.png" alt="before"> <img src="https://image.ponder.work/mweb/2020-10-18-replace-delegation-with-inheritance-after.png" alt="after"></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ol>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/1173730/">重构手册</a></li>
<li><a target="_blank" rel="noopener" href="https://refactoring.guru/refactoring/techniques">https://refactoring.guru/refactoring/techniques</a></li>
</ol>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Jay.Run
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://blog.ponder.work/2020/10/15/%E5%AD%A6%E4%B9%A0%E3%80%8A%E9%87%8D%E6%9E%84%E6%89%8B%E5%86%8C%E3%80%8B/" title="学习《重构手册》">https://blog.ponder.work/2020/10/15/学习《重构手册》/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="tag"># 读书笔记</a>
              <a href="/tags/%E9%87%8D%E6%9E%84/" rel="tag"># 重构</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/09/19/%E5%8D%88%E7%9D%A1%E6%97%B6%E7%9A%84%E6%A2%A6/" rel="prev" title="午睡时的梦">
                  <i class="fa fa-angle-left"></i> 午睡时的梦
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/10/31/raspi-system-backup/" rel="next" title="树莓派系统备份">
                  树莓派系统备份 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2026</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Jay.Run</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">152k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">9:13</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/ruanimal" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"ruanimal","repo":"ruanimal.github.io","client_id":"6a903e3db839fa7a1f0f","client_secret":"c19ebb77db2f0e162961d60afaa89d0f4ed5f3ad","admin_user":"ruanimal","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"fbf971cc9d99d977420ab656929d481f"}</script>
<script src="/js/third-party/comments/gitalk.js" defer></script>
<script>
  document.addEventListener('pjax:success', () => {
    if (CONFIG.sidebar.display !== 'remove') {
      const hasTOC = document.querySelector('.post-toc:not(.placeholder-toc)');

      // 当没有 TOC 且侧边栏正在显示时，隐藏侧边栏
      if (!hasTOC && document.body.classList.contains('sidebar-active')) {
        window.dispatchEvent(new Event('sidebar:hide'));
      }
    }
  });
</script>

</body>
</html>
